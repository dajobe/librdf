2004-07-26  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c:
	Add #ifndef STANDALONE ... #endif around body.

2004-07-23  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_parser.c, librdf/rdf_model.c:
	Replace parser name "raptor" with "rdfxml"

	* configure.ac: raptor min version 1.3.2

	* examples/example4.c, examples/example2.c:
	Replace parser name "raptor" with "rdfxml"

2004-07-21  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/strcasecmp.c, rasqal/roqet.c, rasqal/rasqal_redland.c,
	rasqal/rasqal_raptor.c, rasqal/rasqal_query.c,
	rasqal/rasqal_literal.c, rasqal/rasqal_general.c,
	rasqal/rasqal_expr.c, rasqal/rasqal_engine.c, rasqal/Makefile.am,
	rasqal/win32_config.h, rasqal/win32_rasqal_config.h: rename
	win32_config.h to win32_rasqal_config.h

	* raptor/configure.ac: Bumped version to 1.3.3

	* raptor/configure.ac:
	Removed configuration for gnome glib, pkgconfig and glib-config
	to get g_utf8_normalize for Unicode NFC checking.

	* raptor/raptor_utf8.c (raptor_utf8_is_nfc):
	Removed use of g_utf8_normalize for Unicode NFC
	checking, it seems to give false negatives, is also rather slow since
	it does normalization rather than just checking for NFC.

2004-07-19  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* configure.ac: no need for perl dirs

	* librdf/redland.spec.in: remove redland-perl, redland-python

	* redland-src-config.in: Added --libtool-libs

	* docs/Makefile.am, configure.ac, Makefile.am:
	Updates for move of files and dirs to redland-bindings package

	* docs/ruby.html, docs/tcl.html, docs/csharp.html,
	docs/fix-pod-xhtml, docs/fix-python-xhtml, docs/java.html,
	docs/perl.html, docs/php.html, docs/python.html: Moved to
	redland-bindings package

	* Moved csharp, java, perl, php, python, ruby, tcl directories and
	supporting doc files in docs to the redland-bindings package.
	
	* docs/ruby.html: Point to rdf-redland at RubyForge

	* Redland.i:
	Remove #include <rdf_config.h> since this is now a public file.

2004-07-16  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/Makefile.am, raptor/tests/ex-54.out,
	raptor/tests/ex-54.rdf, raptor/tests/warn-03.out,
	raptor/tests/warn-03.rdf: Renamed warn-03 to ex-54 - it is not an
	error or a warning, the data is good
	
2004-07-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/Makefile.am, raptor/tests/bad-22.rdf:
	bad-22.rdf testing rdf:li forbidden as a property attribute
	(Graham Klyne)

	* csharp/Serializer.cs:
	(Serializer (World world, string name, string mime_type, Uri
	type_uri)): Replace cast to Object with use of Uri.operator==

	* csharp/Uri.cs (Equals, operator ==, operator !=, GetHashCode): Added.

	* csharp/Statement.cs:
	(Statement (World world, Node subject, Node predicate, Node obj)):
	Removed casts to Object and allow calls to Node.operator!=

	* csharp/Node.cs (operator ==, operator !=):
	Added tests for null using Object.Equals
	written by Edd Dumbill.

	* csharp/Redland.cs, csharp/MemoryStorage.cs, csharp/Iterator.cs,
	csharp/IWrapper.cs, csharp/HashStorage.cs, csharp/URI.cs: Added
	CVS IDs to the header.

2004-07-14  Edd Dumbill  <edd@usefulinc.com>

	* csharp/examples/example2.cs:
	write to console when Exiting: helpswith debugging GC snafus.

	* csharp/Makefile.am:
	ensure MONO_PATH=. for running the test prog

	* csharp/Uri.cs:
	general indenting fixes.
	uri: initialise to IntPtr.Zero
	(Dispose): added, implemented IDisposable.

	* csharp/Stream.cs:
	general indenting fixes.
	Implement IDisposable.
	stream: init to IntPtr.Zero.
	(Current): remove tmp var, add FIXME note.
	(MoveNext): remove tmp var dance.
	(End): remove tmp var.
	(CurrentStatement): Added, which is (Statement) Current.

	* csharp/Storage.cs:
	general indenting fixes.
	Implement IDisposable.
	storage: init to IntPtr.Zero

	* csharp/Statement.cs:
	general indenting fixes.
	stm: intialise to IntPtr.Zero
	(Subject, Predicate, Object properties): added get accessors.
	(Statement (IntPtr)): copy underlying statement with
	librdf_statement_new_from_statement
	(~Statement): test for IntPtr.Zero
	(Dispose): Renamed from ~Statement(). Implement IDisposable.

	* csharp/Serializer.cs:
	Implement IDisposable.
	serializer: init to IntPtr.Zero.

	* csharp/QueryResults.cs:
	general indenting fixes.
	query_results: init to IntPtr.Zero;
	Implement IDisposable.
	(MoveNext): remove tmp var.
	(End): remove tmp var.
	(AsStream): remove tmp var, add FIXME note.
	(BindingValue): remove tmp var.
	(BindingValueByName): remove tmp var.
	Implement IEnumerable.
	(QueryResults): remove need to pass original query, make
	constructor internal.

	* csharp/Query.cs:
	general indenting fixes.
	Implement IDisposable.
	query: init to IntPtr.Zero.
	(Query (Word, string, Object, string)): init iuri to IntPtr.Zero,
	not null.  Change third parameter to Uri type, not Object.
	(Query (string)): use constified name for RDQL.
	(Execute): adjust to new form of QueryResults ctor.

	* csharp/Parser.cs:
	general indenting fixes.
	Implement IDisposable.
	parser: init to IntPtr.Zero
	(Parser (World, string, string, Uri)): remove ability to construct
	with null World.
	(ParseIntoModel): add FIXME note.
	(ParseAsStream): add FIXME note.
	(ParseStringAsStream): add FIXME note.

	* csharp/Model.cs:
	general indenting fixes.
	model: initialize to IntPtr.Zero.
	(Dispose). Renamed from ~Model. Implement IDisposable, test for
	IntPtr.Zero.
	(FindStatements): remove unneeded temp var.
	(GetSources): add FIXME item.
	(GetTarget): drop exception and make look like GetPredicate, GetSource.
	(GetTargets): make look like GetSources, GetPredicates. Add FIXME.
	(ToStream): add FIXME note.
	(GetFeature): return null on failure, like GetSource and friends.
	(QueryResults): add FIXME note.
	(Model (World, Storage, string)): keep a reference around to the
	storage, as we must not be GC'd before it is. Future thought: do
	we really need Model and Storage to be separate classes?
	(Execute): adjust to new form of QueryResults ctor (see ChangeLog)

	* csharp/Node.cs:
	general indenting fixes.
	node: initialise to IntPtr.Zero
	(~Node): test for IntPtr.Zero, not == null
	(Node (IntPtr)): use librdf_new_node_from_node to copy underlying
	node.
	(Dispose): Renamed from Move ~Node. Implement IDisposable.

	* csharp/Iterator.cs:
	general indenting fixes.
	Implement IDisposable.
	iterator: init to IntPtr.Zero.
	(Current): remove tmp var, add FIXME note.
	(MoveNext()): remove tmp var, add explanatory comment.
	(End): remove tmp var.
	Remove unused field pos.
	(CurrentNode): Added, which is (Node) Current.

2004-07-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>
	
	* raptor/tests/Makefile.am, raptor/tests/bad-22.rdf:
	bad-22.rdf testing rdf:li forbidden as a
	property attribute (Graham Klyne)

2004-07-13  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/redland.spec.in:
	Use MAKE_PL_OPTS along with "make Makefile.perl" to ensure that the
	right flags get passed in, rather than invoking perl Makefile.PL
	directly

	* perl/Makefile.am: Added MAKE_PL_OPTS for "perl Makefile.PL" target

	* docs/Makefile.am:
	Added RDF::Redland::Query and QueryResults perl docs

2004-07-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/redland.spec.in:
	Ship /usr/share/redland/Redland.i in redland-devel

	* redland-src-config.in, redland-config.in:
	Added --swig option to print the path to the SWIG interface file

	* Makefile.am: Install Redland.i in $(pkgdata)

	* Redland.i, python/Makefile.am, ruby/Makefile.am,
	ruby/redland-pre.i, ruby/redland-types.i, tcl/Makefile.am,
	tcl/redland-init.i, tcl/redland-pre.i, php/Makefile.am,
	php/redland-decl.i, php/redland-init.i, php/redland-post.i,
	php/redland-pre.i, php/redland_wrap.c.patch,
	python/redland-decl.i, python/redland-post.i, perl/Makefile.am,
	perl/redland-decl.i, perl/redland-post.i, perl/redland-pre.i:
	Split SWIG bits into general and language-specific parts

	* librdf/rdf_query_results.c (librdf_query_results_get_bindings):
	Fix docucomment so jade works again

	* docs/api.sgml.in: id="query-results"

2004-07-09  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* docs/Makefile.am:
	Don't ship old pictures overview.png overview.ps overview.pdf

	* csharp/ChangeLog: ChangeLog in CVS now

2004-07-09  Edd Dumbill <edd@usefulinc.com>

	* csharp/World.cs:
	Move logging to use the new librdf logging API.
	(Messages property): Added, an array of LogMessages accumulated since
	the last ClearLog call.
	(LogLevel method): Added, for getting and setting the logging level.

	* csharp/Parser.cs:
	Use World.Messages as the basis of exceptions.

	* csharp/Errors.cs: Added enums LogLevel and Facility.
	Added class Locator to encapsulate locator part of a log message.
	Added class LogMessage to encapsulate a returned log message from
	librdf.
	Changed RedlandFault and RedlandError to store an array of
	LogMessages instead of strings. (Edd Dumbill)

	* librdf/rdf_log.c:
	Add accessors for components of the librdf_log_message type.
	Replace librdf.h, raptor.h with redland.h.

	* librdf/rdf_log.h: add accessors for components of the
	librdf_log_message type.

2004-07-09  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/redland.h: Include rasqal.h, reorder so raptor.h is first.

	* librdf/rdf_query_results.c, librdf/rdf_utf8.c, librdf/rdf_uri.c,
	librdf/rdf_stream.c, librdf/rdf_storage_tstore.c,
	librdf/rdf_storage_mysql.c, librdf/rdf_storage_list.c,
	librdf/rdf_storage_hashes.c, librdf/rdf_storage_file.c,
	librdf/rdf_storage.c, librdf/rdf_statement.c,
	librdf/rdf_serializer_rdfxml.c, librdf/rdf_serializer_raptor.c,
	librdf/rdf_serializer.c, librdf/rdf_query_triples.c,
	librdf/ChangeLog, librdf/rdf_query_rasqal.c, librdf/rdf_query.c,
	librdf/rdf_parser_raptor.c, librdf/rdf_parser.c,
	librdf/rdf_node.c, librdf/rdf_model_storage.c, librdf/rdf_model.c,
	librdf/rdf_list.c, librdf/rdf_iterator.c, librdf/rdf_init.c,
	librdf/rdf_heuristics.c, librdf/rdf_hash_memory.c,
	librdf/rdf_hash_cursor.c, librdf/rdf_hash_bdb.c,
	librdf/rdf_hash.c, librdf/rdf_files.c, librdf/rdf_digest_sha1.c,
	librdf/rdf_digest_openssl.c, librdf/rdf_digest_md5.c,
	librdf/rdf_digest.c, librdf/rdf_concepts.c: Use redland.h in all
	files not a selection of librdf.h, raptor.h and rasqal.h

	* librdf/ChangeLog: ChangeLog in CVS now

2004-07-09  Edd Dumbill <edd@usefulinc.com>
	
	* raptor_locator.c: add accessors for parts of the raptor_locator
	struct.
	* raptor.h: add prototypes for the accessors

2004-07-09  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/ChangeLog, ChangeLog, raptor/ChangeLog: ChangeLog in CVS now

2004-07-08  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/Parser.cs: Added ParseError, a RedlandError subclass.
	(ParseStringIntoModel, ParseIntoModel, ParseStringAsStream): Check
	for errors during parsing.

	* csharp/World.cs: Added Errors, Warnings support
	(ClearLog): Added to empty the errors and warnings lists.
	(Enter): To lock world for gathering errors
	(Exit): To unlock world after gathering errors
	(setupHandlers): Use a delegate intErrorHandler (function pointer in C) to
	register callbacks for errors and warnings.
	(dispatchError, dispatchWarning): Added the error, warning gatherers.

	* csharp/Errors.cs, csharp/Makefile.am: Added Errors.cs

	* examples/example5.c: Updated to use librdf_query_results

	* librdf/rdf_query_results.c (librdf_query_results_get_bindings):
	Added a doc example

	* librdf/rdf_query_results.c: doc

	* librdf/rdf_log.c (librdf_log_simple):
	Use correct user_data.  Patch from René Puls.

	* utils/rdfproc.c (log_handler):
	Added, used to report things here, rather than let the
	default code do it.

	* raptor/raptor_general.c (raptor_parse_uri_with_connection):
	Pass up WWW errors to the parser
	error handler.

	* docs/api.sgml.in: Added QueryResults as a separate file

	* docs/python.html, docs/perl.html, docs/csharp.html:
	Link to docs for query_results.html

	* docs/api.sgml.in: Added QueryResults

	* docs/Makefile.am: Re-add query_results to DOC_CLASSES

	* librdf/rdf_query.h: Added internal librdf_query_add_query_result,
	librdf_query_remove_query_result prototypes

	* librdf/Makefile.am: Added rdf_query_results.c

	* librdf/rdf_query.c, librdf/rdf_query_results.c:
	Moved librdf_query_results to separate file, for doc purposes mostly

	* docs/Makefile.am: remove query_results

	* docs/Makefile.am: added query_results to DOC_CLASSES

2004-07-07  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* perl/lib/RDF/Redland.pm: Added QueryResults.pm

	* perl/example.pl: Added Query and QueryResults test

	* perl/lib/RDF/Redland/QueryResults.pm: working

	* perl/lib/RDF/Redland/Query.pm: Split into query and results classes.

	* perl/lib/RDF/Redland/Model.pm (query_execute): Added.

	* perl/Makefile.PL: Added QueryResults.pm

	* perl/lib/RDF/Redland/QueryResults.pm: QueryResults class

	* perl/lib/RDF/Redland/Makefile.am: Added QueryResults.pm

2004-07-06  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/QueryResults.cs: no need for first

	* csharp/QueryResults.cs:
	Handle first result special, always store current result.

	* csharp/test.cs: print query results

	* csharp/Node.cs: Destructor object checking works now, dunno why.

	* csharp/test.cs: C# query test

	* csharp/QueryResults.cs (Current): Return null when exhausted.

	* csharp/Node.cs:
	Added destructor object checking.  Comment it out since it hangs
	mono and mono-debugger unless run mono -v.

	* csharp/Iterator.cs, csharp/Statement.cs, csharp/Parser.cs:
	Added destructor object checking

	* csharp/Model.cs: Added destructor object checking
	(Execute): Call librdf_model_query_execute

	* csharp/Query.cs: Deleted no-args constructor - does not exist.
	Fixed main constructor.
	Added destructor.

	* csharp/World.cs, csharp/Stream.cs, csharp/Storage.cs,
	csharp/Statement.cs, csharp/Serializer.cs, csharp/Parser.cs,
	csharp/Node.cs, csharp/Model.cs, csharp/Iterator.cs: Added
	destructors for all classes

	* configure.ac: formatting

	* configure.ac:
	Added GACUTIL, SN, ILGAC and report ECMA CLI in languages available

	* csharp/Makefile.am: Typo

	* python/Makefile.am: Use mkinstalldirs to make python install dest

	* configure.ac: Added ilgac, gacutil, sn

	* python/Makefile.am:
	Remove mkdir_p - automake 1.8 only.  Packaging can fix

2004-07-05  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* docs/python.html: Added Rx4RDF

	* docs/python.html, docs/csharp.html: Added Query

	* csharp/QueryResults.cs: pos

	* csharp/Model.cs: Added Execute method

	* csharp/Makefile.am: Added Query.cs QueryResults.cs

	* csharp/Query.cs, csharp/QueryResults.cs: redland csharp Query classes

	* csharp/Model.cs: Added methods: GetContexts, GetFeature,
	SetFeature, Load

	* csharp/Makefile.am: typo

	* utils/rdfproc.c: fixes for erroring out on query failure

	* librdf/rdf_storage.c (librdf_storage_node_stream_to_node_create):
	node2 can be NULL such
	as when called by librdf_storage_get_arcs_out,
	librdf_storage_get_arcs_in.

2004-06-30  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* docs/Makefile.am: Added csharp.html

	* librdf/Makefile.am: Added $(DEFS) to test compile & link lines

	* librdf/rdf_types.h: Define u64 for WIN32 as a typedef for __int64

	* librdf/librdf.h:
	Added REDLAND_STATIC to define REDLAND_API to nothing.

	* raptor/configure.ac: Added RAPTOR_PARSER_TURTLE,
	RAPTOR_PARSER_NTRIPLES and RAPTOR_PARSER_RDFXML all set to 1

	* raptor/raptor_general.c (raptor_init):
	Added RAPTOR_PARSER_TURTLE, RAPTOR_PARSER_NTRIPLES and
	RAPTOR_PARSER_RDFXML

	* librdf/Makefile.am: Added win32_rdf_config.h

	* librdf/win32_rdf_config.h: redland WIN32 hard-coded config

	* librdf/rdf_storage.c, librdf/rdf_storage_file.c,
	librdf/rdf_storage_hashes.c, librdf/rdf_storage_list.c,
	librdf/rdf_storage_mysql.c, librdf/rdf_storage_tstore.c,
	librdf/rdf_stream.c, librdf/rdf_uri.c, librdf/rdf_utf8.c,
	librdf/rdf_hash_memory.c, librdf/rdf_heuristics.c,
	librdf/rdf_init.c, librdf/rdf_iterator.c, librdf/rdf_list.c,
	librdf/rdf_log.c, librdf/rdf_model.c, librdf/rdf_model_storage.c,
	librdf/rdf_node.c, librdf/rdf_parser.c,
	librdf/rdf_parser_raptor.c, librdf/rdf_query.c,
	librdf/rdf_query_rasqal.c, librdf/rdf_query_triples.c,
	librdf/rdf_serializer.c, librdf/rdf_serializer_raptor.c,
	librdf/rdf_serializer_rdfxml.c, librdf/rdf_statement.c,
	librdf/rdf_concepts.c, librdf/rdf_digest.c,
	librdf/rdf_digest_md5.c, librdf/rdf_digest_openssl.c,
	librdf/rdf_digest_sha1.c, librdf/rdf_files.c, librdf/rdf_hash.c,
	librdf/rdf_hash_bdb.c, librdf/rdf_hash_cursor.c: Added #include
	<win32_rdf_config.h> when WIN32 defined

	* raptor/win32_raptor_config.h: 1.3.2

	* raptor/turtle_parser.y, raptor/turtle_lexer.l,
	raptor/strcasecmp.c, raptor/rdfdump.c, raptor/raptor_xml_writer.c,
	raptor/raptor_xml.c, raptor/raptor_www_test.c,
	raptor/raptor_www_libxml.c, raptor/raptor_www_libwww.c,
	raptor/raptor_www_libfetch.c, raptor/raptor_www_curl.c,
	raptor/raptor_www.c, raptor/raptor_win32.c, raptor/raptor_utf8.c,
	raptor/raptor_uri.c, raptor/raptor_stringbuffer.c,
	raptor/raptor_set.c, raptor/raptor_sequence.c,
	raptor/raptor_sax2.c, raptor/raptor_rss.c, raptor/raptor_qname.c,
	raptor/raptor_parse.c, raptor/raptor_namespace.c,
	raptor/raptor_locator.c, raptor/raptor_libxml.c,
	raptor/raptor_identifier.c, raptor/raptor_general.c,
	raptor/raptor_expat.c, raptor/ntriples_parse.c,
	raptor/Makefile.am, raptor/win32_raptor_config.h,
	raptor/win32_config.h: Renamed win32_config.h to
	win32_raptor_config.h

2004-06-29  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_storage.c (librdf_storage_find_statements_in_context):
	When applying map, copy the statement so it can be freed later.

	* librdf/rdf_model.c (librdf_model_find_statements_in_context):
	When applying map, copy the statement so it can be freed later.

	* python/RDF.py: debug msgs

	* python/RDF.py (NS.node):
	Mint a new node each time, don't try to share.

2004-06-28  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/RDF.py (message_handler): Invoke warnings.warn to try to
	get a warning that doesn't disturb the program and shows something
	like the right stack level.

2004-06-25  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/ntriples_parse.c (raptor_ntriples_parse_line):
	Make language on a datatyped literal a warning.

2004-06-24  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c: docs

	* raptor/libraptor.3: date

	* raptor/libraptor.3:
	Added raptor_alloc_memory.  Note where and why it and
	raptor_free_memory may need to be used in the descriptiona
	and next to the methods that it applies to.

	* raptor/raptor_general.c: docs

	* raptor/raptor_general.c, raptor/raptor.h: Added raptor_alloc_memory

	* librdf/rdf_node.c (librdf_node_get_li_ordinal):
	if oops, do not always return -1

2004-06-23  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/Makefile.am: Remove MANIFEST.in

	* rasqal/Makefile.am: Add rule to make libraptor.la

2004-06-22  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_query.h: Added results field to query.
	Added next field to query_results.

	* librdf/rdf_query.c:
	(librdf_query_add_query_result, librdf_query_remove_query_result):
	Now take query_results args.

	* configure.ac: removed --with-libwww - has not been used for
	anything for a long while.

	* python/Makefile.am: Add AM_LDFLAGS to get MEM_LIBS

	* librdf/rdf_query.c:
	Added usage counting of query between query & query-results.
	(librdf_query_add_query_result, librdf_query_remove_query_result): Added
	(librdf_free_query, librdf_new_query_from_factory,
	librdf_new_query_from_query): Added usage counts.
	(librdf_query_execute): Link query to query_results on success.
	(librdf_free_query_results): Do not return after factory cleanup but
	continue to clean up more.

	* librdf/rdf_query.h: Added usage count to query

	* librdf/rdf_query_rasqal.c (librdf_query_rasqal_free_results):
	Do not free query_results here,
	it is done by librdf_free_query_results

	* raptor/configure.ac: Added --with-expat-source option to build
	against an external expat source.
	Handle old and new style expat source areas.
	Report expat source dir in summary.
	Tidy up default messages.
	Only use expat subdir if it exists.

	* raptor/tests/Makefile.am:
	AM_LDFLAGS does not need LIBS, libraptor.la includes it all.

2004-06-21  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/MANIFEST.in: MANIFEST.in gone

	* rasqal/configure.ac: Added --with-dmalloc

	* librdf/rdf_query_rasqal.c (librdf_query_rasqal_free_results):
	Free the query_results

	* rasqal/rasqal_redland.c, librdf/rdf_query_rasqal.c
	(rasqal_redland_bind_match): free the literal returned by
	redland_node_to_rasqal_literal since a new one is made by
	rasqal_literal_as_node.

	* librdf/rdf_query.h:
	query factory free_results method returns no value

	* librdf/rdf_query.c (librdf_free_query_results): Add debug assertion

2004-06-17  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/Makefile.am: added DESTDIR to install target

	* csharp/Makefile.am: fix redland.pub rule

	* rasqal/Makefile.am, raptor/Makefile.am: Zap extra $@ on rule line

	* csharp/redland.pub: Redland.dll public key

	* csharp/Makefile.am: Add warning if redland.pub rule is run

	* csharp/Makefile.am:
	sign-mono rule not needed if AssemblyInfo.cs has redland.pub

	* csharp/Makefile.am: DLL requires redland.pub

	* csharp/AssemblyInfo.cs: Redland.dll Assembly info

	* csharp/Makefile.am: Ship redland.pub (public key)
	Add scary warnings for redland.snk, redland.pub rules.
	Use public key to sign

	* csharp/Makefile.am: Added AssemblyInfo.cs
	Added strong name and signing for mono.

	* csharp/util.cs, csharp/Makefile.am, csharp/Util.cs:
	Renamed util.cs to Util.cs

	* csharp/test.cs: use Serializer

	* csharp/Node.cs (Print): Remove Console.WriteLine

	* csharp/util.cs: Added fputs

	* csharp/test.cs: added printing out results of stream, iterator

	* csharp/test.cs: Remove world, now Redland.dll private.

	* csharp/examples/example4.cs: write, don't append

	* AUTHORS: Merged in csharp/AUTHORS

	* csharp/AUTHORS: Merged into ../AUTHORS

	* csharp/examples/example3.cs: write, don't append

	* csharp/Statement.cs: syntax

	* csharp/Statement.cs: remove set_pointer
	Statement (World world, Node subject, Node predicate, Node obj): copy
	nodes

	* csharp/Node.cs: Added Node copy constructor

	* csharp/examples/Makefile.am: clean just tests

	* csharp/examples/Makefile.am: Require nunit-console.exe

	* csharp/examples/StreamTest.cs: Use ../../data/dc.rdf

	* csharp/examples/Makefile.am, csharp/Makefile.am:
	Remove dup CSHARPCFLAGS

	* csharp/examples/Makefile.am: Add CSHARPCFLAGS

	* csharp/Makefile.am: Add CSHARPCFLAGS, CLI_PREFIX
	Add install-mono, install-pnet

	* configure.ac: Add CSHARPCFLAGS, CLI_PREFIX

	* csharp/Makefile.am:
	Switch to always using ' -' options not mixture of that and ' /' options.
	Added install-mono target

	* csharp/examples/Makefile.am:
	Make nunit-console.exe here (maintainer mode) and ship it.
	Switch to always using ' -' options not mixture of that and ' /' options.

	* csharp/examples/AssemblyInfo.cs, csharp/examples/ConsoleUi.cs:
	nunit-console source unchanged

2004-06-17  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/Makefile.am: added DESTDIR to install target

	* csharp/test.cs: Redland namespace

	* python/test/test.py: test model.matches

	* python/RDF.py (Node.__eq__, Node.__ne__, Statement.__eq__,
	Statement.__ne__, Model.matches, Uri.__eq__, Uri.__ne__):
	Simpler boolean return.

	* csharp/Redland.cs, csharp/Serializer.cs, csharp/Statement.cs,
	csharp/Storage.cs, csharp/Stream.cs, csharp/Uri.cs,
	csharp/Util.cs, csharp/World.cs, csharp/examples/GetsTest.cs,
	csharp/examples/ModelGeneralTest.cs, csharp/examples/ModelTest.cs,
	csharp/examples/SimpleGetsTest.cs, csharp/examples/StreamTest.cs,
	csharp/examples/example1.cs, csharp/examples/example2.cs,
	csharp/examples/example3.cs, csharp/examples/example4.cs,
	csharp/test.cs, csharp/HashStorage.cs, csharp/IWrapper.cs,
	csharp/Iterator.cs, csharp/MemoryStorage.cs, csharp/Model.cs,
	csharp/Node.cs, csharp/Parser.cs: namespace from Rdf to Redland

	* csharp/examples/example3.cs, csharp/examples/example2.cs,
	csharp/examples/example1.cs: Use new Rdf.Uri to make Uris for
	nodes

	* csharp/examples/StreamTest.cs (Contains):
	Make sure a Uri or literal is used correctly.

	* csharp/Node.cs: Added Node constructors with
	just a System.Uri - making a URI node
	just a string - making a literal node
	Modified is_wf_xml arg to be bool.

	* csharp/Model.cs: (Contains) opt bool

	* csharp/examples/example3.cs: don't use token as a name

	* csharp/examples/example4.cs, csharp/examples/example3.cs,
	csharp/examples/example2.cs: tidy test filenames

	* csharp/examples/example1.cs:
	Use serializer.SerializeModel direct to a file.

	* csharp/examples/Makefile.am: tidy test filenames

	* csharp/Util.cs: added fclose

	* csharp/Serializer.cs (SerializeModel):
	Added overloaded method taking a filename and using
	librdf_serializer_serialize_model_to_file to avoid use of file
	handles.

	* csharp/examples/StreamTest.cs (Contains):
	actually test model.Contains

	* csharp/Serializer.cs, csharp/Parser.cs: Use (Object)foo == null

	* csharp/Statement.cs: private Statement (World world, Node
	subject, Node predicate, Node obj): Compare Node pointers for
	nullness as Object to prevent trying to invoke null.opEquality(foo)

	* csharp/Parser.cs: remove debug msg

	* csharp/examples/StreamTest.cs (ParserStringAsStream):
	Remove extra pairs of "s at start and end of rdf/xml string.

	* csharp/Statement.cs: remove debug msg

	* csharp/Parser.cs: debug msg

	* csharp/Statement.cs:
	private Statement (World world, Node subject, Node predicate, Node
	obj): Pass in Handles not C# object refs

	* configure.ac: PKG_CONFIG

	* csharp/Makefile.am: dist contains redland.pub

	* csharp/Makefile.am: fix redland.pub rule

	* rasqal/Makefile.am, raptor/Makefile.am: Zap extra $@ on rule line

	* csharp/redland.pub: Redland.dll public key

	* csharp/Makefile.am: Add warning if redland.pub rule is run

	* csharp/Makefile.am:
	sign-mono rule not needed if AssemblyInfo.cs has redland.pub

	* csharp/Makefile.am: DLL requires redland.pub

	* csharp/AssemblyInfo.cs: Redland.dll Assembly info

	* csharp/Makefile.am: Ship redland.pub (public key)
	Add scary warnings for redland.snk, redland.pub rules.
	Use public key to sign

	* csharp/Makefile.am: Added AssemblyInfo.cs
	Added strong name and signing for mono.

	* csharp/util.cs, csharp/Makefile.am, csharp/Util.cs:
	Renamed util.cs to Util.cs

	* csharp/test.cs: use Serializer

	* csharp/Node.cs (Print): Remove Console.WriteLine

	* csharp/util.cs: Added fputs

	* csharp/test.cs: added printing out results of stream, iterator

	* csharp/test.cs: Remove world, now Redland.dll private.

	* csharp/examples/example4.cs: write, don't append

	* AUTHORS: Merged in csharp/AUTHORS

	* csharp/AUTHORS: Merged into ../AUTHORS

	* csharp/examples/example3.cs: write, don't append

	* csharp/Statement.cs: syntax

	* csharp/Statement.cs: remove set_pointer
	Statement (World world, Node subject, Node predicate, Node obj):
	copy nodes

	* csharp/Node.cs: Added Node copy constructor

	* csharp/examples/Makefile.am: clean just tests

	* csharp/examples/Makefile.am: Require nunit-console.exe

	* csharp/examples/StreamTest.cs: Use ../../data/dc.rdf

	* csharp/examples/Makefile.am, csharp/Makefile.am:
	Remove dup CSHARPCFLAGS

	* csharp/examples/Makefile.am: Add CSHARPCFLAGS

	* csharp/Makefile.am: Add CSHARPCFLAGS, CLI_PREFIX
	Add install-mono, install-pnet

	* configure.ac: Add CSHARPCFLAGS, CLI_PREFIX

	* csharp/Makefile.am: Switch to always using ' -' options not
	mixture of that and ' /' options.  Added install-mono target

	* csharp/examples/Makefile.am:
	Make nunit-console.exe here (maintainer mode) and ship it.
	Switch to always using ' -' options not mixture of that and ' /'
	options.

	* csharp/examples/AssemblyInfo.cs, csharp/examples/ConsoleUi.cs:
	nunit-console source unchanged

2004-06-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/examples/example4.cs: Use ../../data/dc.rdf

	* csharp/examples/dc.rdf: deleted, use data copy

	* csharp/Uri.cs, csharp/Storage.cs, csharp/Statement.cs,
	csharp/Serializer.cs, csharp/Parser.cs, csharp/Node.cs,
	csharp/Model.cs: For P/Invoke where a string is passed in or
	return, switch to IntPtr and manage the strings with
	Marshal.StringToHGlobalAuto and Marshal.FreeHGlobal.

	* python/RDF.py (Statement._wrap_node): Protect from null rednode
	(Statement.matches): Added to compare an incomplete statement with
	None values against a complete one, using Redland.librdf_statement_match

	* csharp/examples/Makefile.am: more CLEANFILES

	* csharp/examples/Makefile.am: unittests depends on ../Redland.dll

	* csharp/Uri.cs, csharp/Node.cs: Debug messages

	* csharp/Makefile.am: Make Redland.dll right

	* csharp/examples/Makefile.am: Unit tests fix

2004-06-13  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* csharp/Statement.cs (Statement.Statement):
	Do not call set_pointer with null pointers.

	* csharp/Node.cs (Equals): Return false if o is null.

	* configure.ac: Added csharp/examples dir

	* csharp/examples/example2.cs, csharp/examples/example3.cs,
	csharp/examples/example4.cs, csharp/examples/GetsTest.cs,
	csharp/examples/Makefile.am, csharp/examples/ModelGeneralTest.cs,
	csharp/examples/ModelTest.cs, csharp/examples/SimpleGetsTest.cs,
	csharp/examples/StreamTest.cs, csharp/examples/TemplateTest.cs,
	csharp/examples/dc.rdf, csharp/examples/example1.cs,
	csharp/Parser.cs, csharp/README, csharp/Redland.cs,
	csharp/Serializer.cs, csharp/Statement.cs, csharp/Storage.cs,
	csharp/Stream.cs, csharp/TODO, csharp/Uri.cs, csharp/World.cs,
	csharp/test.cs, csharp/util.cs,
	csharp/AUTHORS, csharp/HACKING, csharp/HashStorage.cs,
	csharp/IWrapper.cs, csharp/Iterator.cs, csharp/LICENSE,
	csharp/Makefile.am, csharp/MemoryStorage.cs, csharp/Model.cs,
	csharp/Node.cs: Imported redland-csharp by Cesar Lopez Nataren

	* rasqal/configure.ac: Bumped version to 0.9.2

	* raptor/configure.ac: pkg-config is too noisy on errors

	* rasqal/configure.ac: Require raptor 1.3.1

	* rasqal/docs/Makefile.am: README should be maintainer-clean

	* rasqal/configure.ac: removed dup enable-release

	* rasqal/configure.ac, configure.ac, raptor/configure.ac:
	Only muck about with removing -O2 from flags in maintainer mode.

	* rasqal/librasqal.3:
	Added query results class, moved methods over and renamed.

	* rasqal/librasqal.3: example updated

2004-06-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/Makefile.am, raptor/Makefile.am:
	Added local distclean-compile rule to override the insane
	one automake uses by default: rm -f *.tab.c

	* rasqal/librasqal.3: Add 0.9.1 changelog

	* raptor/configure.ac: Bumped version to 1.3.2

	* raptor/tests/Makefile.am: add CLEANFILES

	* raptor/tests/Makefile.am:
	Added TESTS with raptor_empty_test the only one right now.
	Added C include, linking lines

	* raptor/tests/empty.c: Test of empty C file, just using raptor.h work

	* raptor/raptor_uri.c (raptor_uri_filename_to_uri_string, raptor_uri_uri_string_to_filename_fragment):
	Casts and char/unsigned
	char fixes for C++

2004-06-08  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_uri.c (raptor_default_new_uri):
	Avoid free(NULL) for filename.

	* raptor/raptor_general.c (raptor_parse_file):
	Check before fopen that it is not a directory
	attempting to be fopen()ed - unix only, with lstat.

	* raptor/raptor_www.c (raptor_www_file_fetch):
	Check before fopen that it is not a
	directory attempting to be fopen()ed - unix only, with lstat.

	* raptor/rdfdump.c:
	Add error for failure of raptor_uri_filename_to_uri_string

	* raptor/raptor_uri.c (raptor_uri_filename_to_uri_string):
	Unix malloc too large by 2.

	* raptor/raptor_uri.c (raptor_default_new_uri): Zero fragment pointer.

	* raptor/raptor_uri.c (raptor_default_new_uri):
	Do not use a NULL filename.

	* raptor/raptor_uri.c (raptor_uri_uri_string_to_filename_fragment):
	Fail if the URI has no
	path or was going to return an empty string.
	(assert_filename_to_uri): Test code allow checks for NULL.
	(main): Test code for silly URIs that should work or fail.

2004-06-06  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_internal.h: Added RAPTOR_FATAL3

	* raptor/raptor_uri.c:
	Fix win32 file/URI encoding to use file:///name and escape things better.
	(raptor_uri_filename_to_uri_string): Calculate new length correctly,
	with %-escaping.
	(raptor_uri_uri_string_to_filename_fragment): Calculate new format.
	Also do less strlen, strcpy.
	(main): Change tests to match new win32 file URI, test %-escaping
	and %-unescaping correctly.

2004-06-04  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_uri.c:
	NOTE: Not all below is fully working - 3 tests fail at this point.
	(raptor_uri_filename_to_uri_string): %-escape ' ' and '%' at least
	as a minimum.  Document this.  On Windows, generate file:///c:/ ...
	not c|
	(raptor_uri_uri_string_to_filename_fragment): Add %-unescaping.
	(main): Added test cases for %-escaping, %-expanding

	* raptor/Makefile.am: Added raptor_uri_win32_test

2004-06-03  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/turtle/rdfq-results.ttl:
	Updated to http://www.w3.org/2003/03/rdfqr-tests/recording-query-results.html
	CVS $Id: recording-query-results.html,v 1.9 2004/06/03 12:41:37 aseaborne Exp $

2004-06-02  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/redlandtest.py:
	Updated tests to match query to query+query_results split
	and removal of run_as_bindings style.

	* python/RDF.py (Model): Removed run_as_bindings.
	Replaced run_as_statements with execute and wrapping of stream.
	Added execute.
	(Query): Removed __len__
	Removed run_as_bindings.
	Replaced run_as_statements with as_stream.
	Added execute.
	(QueryResults): Renamed from QueryResultIterator
	Added more methods from the librdf_query API:
	as_stream, finished, get_binding_value, get_binding_name,
	get_binding_value_by_name, get_bindings_count.
	Added __del__ to tidy up.

2004-06-01  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/rasqal_query.c (rasqal_free_query_results,
	rasqal_query_results_get_count, rasqal_query_results_next,
	rasqal_query_results_finished, rasqal_query_results_get_bindings,
	rasqal_query_results_get_binding_value,
	rasqal_query_results_get_binding_name,
	rasqal_query_results_get_binding_value_by_name,
	rasqal_query_results_get_bindings_count): Defensive checking for
	non-NULL query_results.

	* rasqal/docs/kernel-doc, docs/kernel-doc:
	ensure id in the SGML is always same size with md5sum

	* utils/rdfproc.c, Redland.i: Added librdf_query_results.
	Renamed all librdf_query results methods to match (like rasqal 0.9.1)

	* librdf/librdf.h: Added librdf_query_results

	* librdf/rdf_storage.c, librdf/rdf_storage.h:
	Removed librdf_storage_query_as_stream,
	librdf_storage_query_as_bindings and replaced with
	librdf_storage_query_execute

	* librdf/rdf_model_storage.c:
	Removed librdf_model_storage_query_as_stream,
	librdf_model_storage_query_as_bindings and replaced with
	librdf_model_storage_query_execute

	* librdf/rdf_model.c:
	Removed librdf_model_query, librdf_model_query_string,
	librdf_model_query_as_stream, librdf_model_query_as_bindings and
	replaced with librdf_model_query_execute

	* librdf/rdf_model.h:
	In factory, removed query_as_stream, replaced with query_execute.
	Removed librdf_model_query, librdf_model_query_string,
	librdf_model_query_as_stream, librdf_model_query_as_bindings and
	replaced with librdf_model_query_execute

	* librdf/rdf_query_triples.c, librdf/rdf_query_rasqal.c,
	librdf/rdf_query.c, librdf/rdf_query.h: Added librdf_query_results.
	Renamed all librdf_query results methods to match (like rasqal 0.9.1)

	* rasqal/rasqal_query.c (rasqal_query_remove_query_result): Init prev.

	* rasqal/rasqal_query.c:
	(rasqal_query_results_get_binding_value_by_name)
	Renamed from rasqal_query_results_get_binding_by_name.

	* rasqal/rasqal.h: rasqal_query_results_get_binding_by_name to
	rasqal_query_results_get_binding_value_by_name

	* rasqal/roqet.c: Use rasqal_query_results apis

	* configure.ac: require Rasqal 0.9.1

	* rasqal/rasqal_query.c (rasqal_new_query, rasqal_free_query):
	Use usage.
	(rasqal_query_execute): Return a new rasqal_query_results* object
	and add it to the query object with rasqal_query_add_query_result.
	(rasqal_query_add_query_result, rasqal_query_remove_query_result): Added
	(rasqal_free_query_results): Added to destroy rasqal_query_results* object
	Renamings:
	rasqal_query_get_result_count => rasqal_query_results_get_count
	rasqal_query_next_result => rasqal_query_results_next
	rasqal_query_results_finished => rasqal_query_results_finished
	rasqal_query_get_result_bindings => rasqal_query_results_get_bindings
	rasqal_query_get_result_binding_value => rasqal_query_results_get_binding_value
	rasqal_query_get_result_binding_name => rasqal_query_results_get_binding_name
	rasqal_query_get_result_binding_by_name => +rasqal_query_results_get_binding_by_name
	rasqal_query_get_bindings_count => rasqal_query_results_get_bindings_count

	* rasqal/rasqal_internal.h:
	rasqal_query_s: Added usage counts, results pointing to active
	rasqal_query_results* for this query.
	Added rasqal_query_results_s structure.

	* rasqal/rasqal.h: Added rasqal_query_results class.
	Made rasqal_query_execute return a rasqal_query_result*
	Renamed all rasqal_query*result* methods to be rasqal_query_result_*
	Added rasqal_free_query_results to tidy up.

	* rasqal/rasqal_engine.c (rasqal_engine_build_constraints_expression):
	Use AND between constraints.

2004-05-31  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c (raptor_parser_error_varargs,
	raptor_parser_warning_varargs): Chop off trailing \n from
	messages.

	* raptor/raptor_libxml.c (raptor_libxml_error):
	Chop off trailing \n correctly.

2004-05-30  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_lexer.l: Set the uri union field for ':' qname.

	* raptor/turtle_parser.y (raptor_turtle_parse_start):
	Delete any existing buffer content before
	starting.

	* raptor/raptor_general.c:
	Added feature warn_other_parseTypes, default true in lax mode.

	* raptor/raptor_parse.c:
	Added feature warn_other_parseTypes and used to warn when a parseType
	Literal is assumed.

	* raptor/raptor_internal.h: Added feature warn_other_parsetypes

	* raptor/raptor.h: Aded feature warn_other_parsetypes

	* raptor/tests/warn-07.out, raptor/tests/warn-07.rdf:
	Replaced by warn-07

	* raptor/tests/Makefile.am: Remove ex-50, warn-07 covers it

	* raptor/tests/ex-50.out, raptor/tests/ex-50.rdf: Replaced by warn-07

	* raptor/tests/Makefile.am: Add warn-07
	Check for right values for warning tests, not just presence of a
	warning.

	* rasqal/Makefile.am:
	Don't use RASQAL_INTERNAL_LIBS except in dependencies of librasqal.la

	* utils/Makefile.am, librdf/Makefile.am, examples/Makefile.am:
	Don't use LIBRDF_INTERNAL_LIBS except in dependencies of librdf.la

	* python/RDF.py (set_message_handler): docs

	* Redland.i:
	Update python message callback, send everything to user code.

	* python/RDF.py: Make this 1.0

	* perl/t/test3.t, perl/lib/RDF/Redland.pm (message):
	Return a handled value

	* Redland.i:
	For perl, return a handled flag for error, warning messages.
	(librdf_call_perl_message): Use return value for
	RDF::Redland::World::message.
	(librdf_perl_error_handler, librdf_perl_warning_handler): Add
	return value

	* librdf/rdf_log.h: librdf_log_level_func has a return value

	* librdf/rdf_log.c (librdf_log_simple):
	Return if error, warning messages are handled
	by the specific handlers.

	* perl/lib/RDF/Redland/Query.pm: more missing ;s
	Use $self not $query

	* perl/lib/RDF/Redland/Query.pm: missing ;s

	* examples/Makefile.am: Tidy up AM_*FLAGS, remove @LIBRDF_LIBS@

	* utils/Makefile.am: Remove @LIBRDF_LIBS@

	* rasqal/rasqal_internal.h: remove duplicate and broken YYDEBUG lines

	* python/test/test.py: dc.rdf now in data

	* python/redlandtest.py: dc.ttl

	* Makefile.am: Add data to dist subdirs

	* python/redlandtest.py:
	Patch from Matt Biddulph adding unit tests for the new Query class
	and the  new NtriplesParser, TurtleParser parsing classes.
	Amended to move the test data files into ../data.

	* python/RDF.py: Patch from Matt Biddulph adding:
	(Model.run_as_bindings): Added to run a querying giving variable
	binding results.
	(Model.run_as_statements): Added to run a querying giving triple results.
	(TurtleParser, NTriplesParser): New convenience classes to create
	parsers for the Turtle and N-Triples syntaxes.
	(Query class): New class for querying using the new librdf_query
	Redland class.
	(QueryResultIterator class): New class for iterativing over variable
	binding results.

	* python/example.py: last change from Matt Biddulph

	* python/example.py: dc.rdf now in data dir
	Add RDF.Query test

	* ruby/example.rb, ruby/Makefile.am, php/test.php,
	perl/example.pl, perl/Makefile.am, perl/MANIFEST, java/test2.java,
	java/test1.java, examples/example4.c, docs/tcl.html,
	docs/ruby.html, docs/python.html, docs/perl.html: dc.rdf now in
	data dir

	* data/Makefile.am: dc.ttl

	* data/Makefile.am, data/dc.nt, data/dc.rdf, data/dc.ttl: data

	* configure.ac, Makefile.am: Added data dir

2004-05-29  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* perl/dc.rdf: moved to ../data

	* autogen.sh, rasqal/autogen.sh, raptor/autogen.sh:
	Add --enable-maintainer-mode

	* raptor/configure.ac:
	Add check for glib-2.0 presence rather than an error barf.

	* librdf/redland.pc.in: Use LIBRDF_PKGCONFIG_LIBS

	* configure.ac: Made RASQAL_MIN_VERSION 0.9.0
	Added LIBRDF_PKGCONFIG_LIBS for redland.pc

	* librdf/redland.pc.in: Replace LIBRDF_LIBS with LIBRDF_EXTERNAL_LIBS

	* librdf/Makefile.am: Remove LIBRDF_LIBS and add LIBRDF_INTERNAL_LIBS

	* redland-src-config.in, redland-config.in: Remove LIBRDF_LIBS

	* configure.ac:
	Remove use of LIBRDF_LIBS - merge into LIBRDF_EXTERNAL_LIBS and do not
	AC_SUBST.
	Always append to LIBRDF_LIBS, LIBRDF_CPPFLAGS rather than prepend,
	append mixtures.

2004-05-28  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* configure.ac: Look for BDB in /usr/local/BerkeleyDB.$version

	* configure.ac: typo: RASQAL_CONFIG

	* raptor/tests/Makefile.am, rasqal/tests/Makefile.am,
	rasqal/rdql-testsuite/Makefile.am: Add set +e, set -e around
	multiple tests so they only fail at the end.

	* docs/Makefile.am:
	do not overwrite redland.3 if not in maintainer mode

	* librdf/Makefile.am: Use automakefile conditional MEMCMP

	* utils/Makefile.am: Use automakefile conditional GETOPT

	* configure.ac: Use automakefile conditionals MEMCMP and GETOPT

	* rasqal/configure.ac: Add flex version check, only in maintainer mode

	* rasqal/Makefile.am: Make lex and yacc rules be maintainer only.

	* raptor/configure.ac: Only check flex version in maintainer mode

	* raptor/Makefile.am: Re-order directives and tidy up.
	Make lex and yacc rules be maintainer only.

	* rasqal/configure.ac:
	Use automakefile conditionals STRCASECMP and GETOPT

	* rasqal/Makefile.am: Use automakefile conditionals STRCASECMP and
	GETOPT for conditional sources.  Re-order the directives slightly.

	* raptor/Makefile.am: Use automakefile conditionals STRCASECMP and
	GETOPT for conditional sources.

	* raptor/configure.ac:
	Use automakefile conditionals STRCASECMP and GETOPT

2004-05-27  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/configure.ac, raptor/configure.ac: check for perl

	* rasqal/Makefile.am, raptor/Makefile.am: Add fix-flex and use it

	* rasqal/fix-flex, raptor/fix-flex: Fix flex output

	* raptor/raptor_internal.h: Added raptor_libxml_free

	* raptor/raptor_parse.c (raptor_xml_parse_start,
	raptor_xml_parse_terminate): Use raptor_libxml_free to tidy up.

	* raptor/raptor_libxml.c (raptor_libxml_free):
	Added to tidy up after a parsing.

	* raptor/raptor_parse.c (raptor_xml_parse_terminate):
	Clean up sax2_element stack after
	errors.

2004-05-26  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_lexer.l: Allow _ after : in qnames.
	Make bare ':' work.

	* raptor/tests/turtle/rdf-schema.out,
	raptor/tests/turtle/rdf-schema.ttl: RDF namespace document

	* raptor/tests/turtle/rdfs-namespace.out,
	raptor/tests/turtle/rdfs-namespace.ttl: RDFS namespace

	* raptor/tests/turtle/Makefile.am:
	Added test-13, rdf-schema, rdfs-namespace

	* raptor/tests/turtle/test-13.out, raptor/tests/turtle/test-13.ttl:
	test bare :

	* raptor/turtle_parser.y: Fix RAPTOR_DEBUG args in old format.

	* raptor/tests/turtle/Makefile.am: Added test-12

	* raptor/tests/turtle/test-12.out, raptor/tests/turtle/test-12.ttl:
	test for _ after : in qnames

	* raptor/libraptor.3:
	Describe use of UTF-8 for literals and strings

	* raptor/libraptor.3: 1.3.1 changes

2004-05-25  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor.h:
	Added RAPTOR_STATIC for WIN32 when statically linking
	Fix raptor_print_statement arg s/const//

2004-05-24  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c (raptor_free_memory, raptor_system_free):
	Do not return, no return value.

2004-05-21  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/turtle/rdfq-results.ttl,
	raptor/tests/turtle/rdfq-results.out: Replace XML Schema namespace
	with 2001 versi

2004-05-19  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/rdfdump.c: Includes re-order, doc

	* raptor/rdfdump.c: don't do stdarg.h here - it should be in raptor.h

	* raptor/raptor.h:
	Add include for stdarg.h to get va_list for raptor_vsnprintf

	* raptor/raptor_xml.c (raptor_xml_escape_string):
	q should be an unsigned char*

	* raptor/raptor_utf8.c (raptor_unicode_char_to_utf8):
	Cast for unsigned long to unsigned char

	* raptor/raptor_parse.c (raptor_xml_start_element_handler):
	Cast for memcpy.

	* raptor/win32_config.h: patch from Jose for VC6

2004-05-18  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* Redland.i: Fake librdf_new_query taking char* not unsigned char*

	* perl/lib/RDF/Redland/Makefile.am: Added Query.pm

	* perl/lib/RDF/Redland/Query.pm: RDF query api

	* perl/Makefile.PL, perl/lib/RDF/Redland.pm: Added Query.pm

	* librdf/rdf_query_rasqal.c:
	Update for renaming of librdf_query_get_result_binding_by_name to
	librdf_query_get_result_binding_value_by_name and factory equiv.

	* librdf/rdf_query.h: Renamed librdf_query_get_result_binding_by_name
	to librdf_query_get_result_binding_value_by_name
	and factory equiv.

	* librdf/rdf_query.c (librdf_query_get_result_binding_value_by_name):
	Renamed from
	librdf_query_get_result_binding_by_name

	* Redland.i: Export librdf_query class and methods.
	Export model methods librdf_model_query_as_stream,
	librdf_model_query_as_bindings

	* raptor/ntriples_parse.c (raptor_ntriples_generate_statement):
	Remove use of ntriples_parser, not used.

2004-05-15  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/configure.ac: Bumped version to 0.9.1

	* rasqal/rasqal.spec.in, raptor/raptor.spec.in: SNAP

	* rasqal/rdql-testsuite/Makefile.am:
	Improve checking works/correct against expected failures.

	* rasqal/rdql-testsuite/Makefile.am:
	Check works/correct RDQL tests against expected failures.

	* rasqal/rdql-testsuite/check-rdql: Use portable diff -u in errors

2004-05-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* rasqal/configure.ac: 0.9.0

	* rasqal/docs/Makefile.am: Added README, README.html

	* rasqal/Makefile.am: Add RELEASE.html

2004-05-13  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_internal.h: Use positive assert enable defines.

	* configure.ac: Turn assert enable options into positive form.

	* rasqal/rasqal_literal.c: docucomments

	* rasqal/fix-groff-xhtml, raptor/fix-groff-xhtml: update for rasqal

	* rasqal/librasqal.3: updated for release

	* rasqal/rasqal.h: dead prototype

	* librdf/rdf_query_rasqal.c (rasqal_redland_bind_match):
	use redland_node_to_rasqal_literal

	* rasqal/rasqal_internal.h, rasqal/rasqal.h:
	Export rasqal_literal_as_node.

	* rasqal/rasqal_redland.c (rasqal_redland_bind_match):
	use redland_node_to_rasqal_literal

	* rasqal/rasqal_literal.c (rasqal_literal_equals):
	Boolean literals compare equal to string
	literals "true" or "false".

	* rasqal/rasqal_literal.c: Throughout - use RASQAL_CALLOC
	(rasqal_literal_as_floating): Added
	(rasqal_literal_compare): Add more debug messages.
	Promote to floating right.
	(rasqal_literal_as_node): Make a new string literal for integer,
	floating here.

	* rasqal/rdql-testsuite/check-rdql:
	Do not hack around roqet emitng integer, floating,
	Do hack around rapper/raptor 1.3.0 bug

	* rasqal/rasqal_literal.c (rasqal_literal_compare):
	In promoting comparisons, check both ways
	round before turning to next type.

	* rasqal/rasqal_raptor.c (rasqal_raptor_bind_match):
	Use rasqal_literal_as_node in setting
	bindings.

	* rasqal/rasqal_internal.h: Add rasqal_literal_as_node

	* rasqal/rasqal_literal.c (rasqal_new_string_literal,
	rasqal_literal_expand_qname): Discard language if datatype is
	given.

	* rasqal/rdql-testsuite/check-rdql:
	Turn internal integer, floating into typed literals.

2004-05-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_parser.y, raptor/turtle_common.h,
	raptor/ntriples_parse.c: Do not allow any language with datatype
	literals.

	* rasqal/rdql-testsuite/check-rdql: report failures

	* raptor/tests/turtle/Makefile.am: add zip, tests.zip targets

2004-05-11  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/configure.ac: Bumped version to 1.3.1

	* raptor/raptor.spec.in: Added RELEASE.html

	* raptor/Makefile.am: Added RELEASE.html

	* raptor/turtle_lexer.l: Allow - in qnames, prefix qnames.

	* raptor/tests/turtle/Makefile.am: Added test-11

	* raptor/tests/turtle/test-11.out, raptor/tests/turtle/test-11.ttl:
	- and _ in qnames, prefixes

	* ruby/test/Makefile.am: Use stamp rule to ensure module is built.

	* ruby/Makefile.am: Rename stamp rule to be indep of the package name.

	* ruby/test.rb: kill test.rb

	* ruby/test/Makefile.am: echo failure line

	* ruby/test/ical.rdf, ruby/test/triples.rdf: Ruby RDF test data

	* ruby/test/Makefile.am: Move rdf example data here.
	Add clean target.
	Tidy test running target.

	* ruby/Makefile.am: Remove test.rb

	* ruby/ical.rdf, ruby/triples.rdf: Moved to test dir

	* ruby/test/Makefile.am: Set -I paths right

	* configure.ac: use = not == in test

	* configure.ac: Make rasqal build internal and external.
	Add ruby test, lib dirs.

	* ruby/lib/rdfs/Makefile.am, ruby/test/Makefile.am,
	ruby/lib/Makefile.am, ruby/lib/rdf/Makefile.am, ruby/Makefile.am:
	Import more of Ruby RDF for Redland

2004-05-07  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_query_rasqal.c: New error/warning handler names

	* rasqal/rasqal_query.c (rasqal_query_print):
	Don't try to print NULL sequences.

	* rasqal/docs/Makefile.am,
	rasqal/docs/api.sgml.in, rasqal/docs/build-docs,
	rasqal/docs/kernel-doc: Rasqal docs and API manual

	* rasqal/configure.ac, rasqal/Makefile.am: Added docs

	* rasqal/rasqal_query.c: docucomment

	* rasqal/rasqal_general.c:
	Rename various functions, moved from here to rasqal_query.c:
	rasqal_query_get_name, rasqal_query_get_label,
	rasqal_query_set_fatal_error_handler, rasqal_query_set_error_handler,
	rasqal_query_set_warning_handler, rasqal_query_set_feature

	* rasqal/rasqal_query.c:
	Rename various functions, moved to this rasqal_query.c:
	rasqal_query_get_name, rasqal_query_get_label,
	rasqal_query_set_fatal_error_handler, rasqal_query_set_error_handler,
	rasqal_query_set_warning_handler, rasqal_query_set_feature

	* rasqal/rasqal.h: Renames: Now rasqal_query* for the following name:
	rasqal_get_name, rasqal_get_label,
	rasqal_set_fatal_error_handler, rasqal_set_error_handler,
	rasqal_set_warning_handler, rasqal_set_feature

	* rasqal/rasqal_expr.c: Docucomments for variable class.

	* rasqal/rdql_parser.y (rasqal_rdql_query_engine_prepare):
	Handle NULL query_string.

	* rasqal/rasqal_internal.h:
	Internal: rasqal_literal_as_boolean, rasqal_literal_as_integer

	* rasqal/rasqal.h: Do not export rasqal_literal_as_boolean

	* rasqal/Makefile.am: Add rasqal_literal.c

	* rasqal/rasqal_expr.c, rasqal/rasqal_literal.c:
	Rasqal literal moved from rasqal_expr.c

	* rasqal/rasqal_expr.c: docucomment

	* rasqal/rasqal_expr.c:
	Docucomments for all literal constructors, destructors, methods,
	helpers.

	* rasqal/rasqal_expr.c: code style

	* rasqal/rasqal_query.c (rasqal_query_prepare):
	Note query_string can be NULL.

	* examples/example5.c:
	Error check model or storage failure; make new store.

	* librdf/rdf_parser_raptor.c
	(librdf_parser_raptor_generate_id_handler): Use raptor_free_memory
	to free raptor alloced id

	* librdf/rdf_query.c: Don't use uninitialised names.

	* librdf/rdf_query.c, rasqal/rasqal_query.c: docucomments

	* utils/rdfproc.c:
	Use names/values methods for query results, no need for a static array.

	* rasqal/roqet.c:
	Use names/values methods for results, no need for a static array.

	* librdf/rdf_query_rasqal.c (librdf_query_rasqal_get_result_bindings):
	Use rasqal_query_get_bindings_count.
	(librdf_query_rasqal_get_bindings_count): Added, calling
	rasqal_query_get_bindings_count.

	* librdf/rdf_query.c (librdf_query_get_bindings_count): typo

	* librdf/rdf_query.h: Added get_bindings_count factory method

	* librdf/rdf_query.h: Added librdf_query_get_bindings_count

	* librdf/rdf_query.c (librdf_query_get_bindings_count): Added.

	* rasqal/rasqal_query.c: Docucomments.
	(rasqal_query_get_bindings_count): Added

	* rasqal/roqet.c, utils/rdfproc.c: Don't use uninitialised values.

	* rasqal/roqet.c: Don't use uninitialised names, values.

	* utils/rdfproc.c:
	(query command) Don't use uninitialised names, values, count.
	Run the query(!) before trying to get results.

	* rasqal/rasqal.h: Added rasqal_query_get_bindings_count

	* rasqal/rasqal_query.c (rasqal_query_prepare):
	Free raptor-alloced memory with raptor_free_memory.
	(rasqal_query_get_bindings_count): Added.

	* raptor/raptor_sequence.c, raptor/raptor_internal.h: Add assert macros

	* utils/rdfproc.c:
	Add URI field to query arg, allow - for optional name, URI
	Handle query constructor failing.

	* librdf/rdf_query_rasqal.c (librdf_query_rasqal_error_handler,
	librdf_query_rasqal_warning_handler): Added
	(librdf_query_rasqal_init): Hook up above when initialising a new
	query.

	* librdf/rdf_log.c (librdf_log_simple):
	Too annoying to die for regular errors when
	debugging.

	* rasqal/roqet.c: Add list of valid inputs for -i/--input errors.

	* rasqal/rasqal_query.c: parameter naming consistency (no code changes)
	docucomments

	* Redland.i: Added librdf_statement_match

	* utils/rdfproc.c:
	Remove check here for contexts and rely on run time warnings from
	model and/or storage classes.

	* librdf/rdf_storage_list.c
	(librdf_storage_list_context_add_statement,
	 librdf_storage_list_context_remove_statement):
	Run time warning if called with a non-NULL context and contexts
	are not supported.
	(librdf_storage_list_context_serialise,
	librdf_storage_list_get_contexts): Run time warning if called
	and contexts are not supported.

	* librdf/rdf_storage_hashes.c (librdf_storage_hashes_get_contexts):
	Run time warning if called
	and contexts are not supported.

	* librdf/rdf_storage_hashes.c
	(librdf_storage_hashes_context_add_statement,
	librdf_storage_hashes_context_serialise):
	Run time warning if called and contexts are not supported.
	(librdf_storage_hashes_context_remove_statement): Run time warning
        if called with a non-NULL context and contexts are not supported.

	* librdf/rdf_model.c (librdf_model_supports_contexts):
	Added helper, internal.
	(librdf_new_model_with_options, librdf_new_model_from_model):
	Initialise supports_contexts.
	(librdf_model_context_add_statement,
	librdf_model_context_add_statements,
	librdf_model_context_remove_statement,
	librdf_model_context_remove_statements,
	librdf_model_context_as_stream,
	librdf_model_context_serialize,
	librdf_model_get_contexts): Run time warning if called and contexts
	are not supported.
	(librdf_model_find_statements_in_context): Run time warning if called
	with a non-NULL context and contexts are not supported.

	* librdf/rdf_model.h: Added supports_contexts internal field.

	* java/org/librdf/redland/Statement.java: Added equals method.

	* ruby/lib/rdf/statement.rb: Added == operator

	* perl/lib/RDF/Redland/Statement.pm: Added equals method.

	* python/RDF.py (Model.__eq__, Model.__ne__):
	Added for statement equality, inequality.

	* python/redlandtest.py:
	Added tests for statement equality, inequality.

	* Redland.i: Added librdf_statement_equals

2004-05-06  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_query.c (main): Free model, storage

	* librdf/rdf_query.c: foo

	* librdf/rdf_query.c: (main) free returned query variable values

	* examples/example5.c, utils/rdfproc.c:
	free returned query variable values

	* examples/example5.c: comments

	* librdf/rdf_parser.h:
	Deleted internal librdf_parser_error and librdf_parser_warning
	Deprecated librdf_parser_set_error and librdf_parser_set_warning.

	* librdf/rdf_parser.c (librdf_parser_error, librdf_parser_warning):
	Deleted - internal and never used.
	(librdf_parser_set_error, librdf_parser_set_warning): Deprecated,
	never worked.

	* README.html: +Query

	* librdf/rdf_query.c: docucomments

	* docs/api.sgml.in: remove list

	* docs/api.sgml.in:
	less doc classes; no real need for the implementation classes.
	Removed GFDL.  The docs have the same license as Redland now.

	* docs/Makefile.am:
	less doc classes; no real need for the implementation classes.

	* docs/Makefile.am: Added query_rasqal for docs

	* librdf/rdf_query.c: Added assertions

	* librdf/rdf_query_rasqal.c:
	Renamed librdf_query_rasqal_get_result_binding to
	librdf_query_rasqal_get_result_binding_value.
	Added librdf_query_rasqal_get_result_binding_name

	* librdf/rdf_query.h:
	Renamed librdf_query_get_result_binding to
	librdf_query_get_result_binding_value.
	Added librdf_query_get_result_binding_name
	Changed factory methods to match.

	* librdf/rdf_query.c (librdf_query_get_result_binding_value):
	Renamed from
	librdf_query_get_result_binding.
	(librdf_query_get_result_binding_name): Added.

	* rasqal/rasqal.h: Renamed rasqal_query_get_result_binding to
	rasqal_query_get_result_binding_value.  Added
	rasqal_query_get_result_binding_name

	* rasqal/rasqal_query.c (rasqal_query_get_result_binding_value):
	Renamed from
	rasqal_query_get_result_binding. Fix dubious offset checking.
	(rasqal_query_get_result_binding_name): Added.

	* librdf/rdf_query_triples.h: deleted, not needed

	* librdf/rdf_query.c: docucomment

	* python/RDF.py: document using contexts

2004-05-05  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_query.c: add vars

	* librdf/rdf_query.c (main): Added a real query language test.

	* utils/rdfproc.c: Added query, use of query with variable bindings

	* librdf/rdf_model.h:
	Added librdf_model_query_as_stream, librdf_model_query_as_bindings,
	librdf_model_query_string

	* librdf/rdf_model.c (librdf_model_query_as_stream,
	librdf_model_query_as_bindings): Added
	(librdf_model_query_string): Deprecated

	* librdf/rdf_storage.h:
	Added librdf_storage_query_as_stream, librdf_storage_query_as_bindings

	* librdf/rdf_storage.c
	(librdf_storage_query_as_stream,librdf_storage_query_as_bindings):
	Added

	* librdf/rdf_query.h: Substantially changed.
	open, close methods gone.
	Added all the binding access methods from rasqal.

	* librdf/rdf_query.c: Substantially changed.
	open, close gone.
	(librdf_query_run_as_stream,librdf_query_run_as_bindings): Added
	Added all the binding access methods from rasqal.

	* librdf/rdf_query_rasqal.c: Querying with Rasqal

	* librdf/rdf_model_storage.c
	(librdf_model_storage_query_as_stream,
	librdf_model_storage_query_as_bindings): Added.

	* examples/Makefile.am: Added example5

	* examples/example5.c: query example

	* librdf/rdf_query_triples.c: Remove open, close methods.
	Rename run method.

	* librdf/rdf_init.h: added query_factories to world

	* librdf/Makefile.am:
	Removed rdf_query_triples.h, added rdf_query-rasqal.c

	* rasqal/rasqal.h:
	Added rasqal_query_get_user_data and rasqal_query_set_user_data

	* rasqal/rasqal_query.c
	(rasqal_query_get_user_data,rasqal_query_set_user_data): Added

	* rasqal/rasqal_query.c: docucumments

	* rasqal/rasqal.spec.in: date

	* rasqal/rasqal.spec.in, rasqal/rasqal.pc.in, rasqal/configure.ac:
	Use new @RAPTOR_MIN_VERSION@ subst.

	* rasqal/Makefile.am: Install roqet

	* rasqal/Makefile.am: Added roqet.1 and roqet.html, add fix-groff-xhtml

	* rasqal/roqet.1: roqet man page

	* configure.ac: make PHP_INCLUDES even without --with-php (ie PHP)

	* tcl/Makefile.am, ruby/Makefile.am, python/Makefile.am,
	php/Makefile.am, perl/Makefile.am, java/Makefile.am,
	csharp/Makefile.am: Apply CFLAGS, CPPFLAGS to pick up internal,
	external includes and src/build dirs.

	* rasqal/configure.ac: SUBST with_raptor

	* rasqal/rasqal-src-config.in: sigh, rasqal uses raptor

	* rasqal/rasqal-src-config.in, redland-src-config.in:
	One more remaining bad raptor cut'n' paste

	* rasqal/rdql-testsuite/Makefile.am: Add check-rdql to dist

	* rasqal/configure.ac: Added build summary.

	* rasqal/rasqal_raptor.c: (raptor_statement_as_rasqal_triple) C99.

	* rasqal/configure.ac: Try to find raptor sources better.

	* configure.ac: assign rasqal_dir for SD_PRE

	* Makefile.am: Added ChangeLog.4

	* librdf/rdf_internal.h: Removed LIBRDF_DEBUG macros

	* librdf/rdf_init.h:
	Removed librdf_error, librdf_warning as no longer used.

	* librdf/rdf_log.c (librdf_log_simple):
	When debugging, all errors are fatal.
	(librdf_error, librdf_warning): Removed, no longer used.

	* librdf/rdf_stream.c, librdf/rdf_storage_tstore.c,
	librdf/rdf_storage_list.c, librdf/rdf_storage_hashes.c,
	librdf/rdf_storage.c, librdf/rdf_statement.c,
	librdf/rdf_serializer_rdfxml.c, librdf/rdf_serializer_raptor.c,
	librdf/rdf_query.c, librdf/rdf_parser_raptor.c, librdf/rdf_node.c,
	librdf/rdf_model.c, librdf/rdf_list.c, librdf/rdf_hash_memory.c,
	librdf/rdf_hash_bdb.c, librdf/rdf_hash.c, librdf/rdf_digest.c:
	Replace LIBRDF_DEBUG macro uses with librdf_log

	* librdf/redland.spec.in, librdf/redland.pc.in, configure.ac:
	SUBST raptor, rasqal min versions and use in build, packaging files.

	* librdf/redland.pc.in: added rasqal

	* redland-src-config.in: more with_rasqal fixes

	* configure.ac: SUBST with_rasqal

	* redland-src-config.in, librdf/redland.spec.in: added rasqal

	* configure.ac: report rasqal source in summary

	* librdf/Makefile.am, configure.ac: added rasqal

	* Makefile.am: Added rasqal

2004-05-04  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/libraptor.3: rewordings

	* rasqal/rasqal_raptor.c, rasqal/rasqal_expr.c:
	raptor now exports raptor_xml_literal_datatype_uri_string

	* raptor/raptor_general.c, raptor/raptor.h:
	Export raptor_xml_literal_datatype_uri_string

	* raptor/raptor_internal.h:
	raptor_xml_literal_datatype_uri_string now exported.

	* raptor/libraptor.3: Added 1.3.0 items

	* raptor/raptor_general.c (raptor_parse_uri_with_connection):
	Document the Accept: header malarky.
	Only send it if connection is NULL.  Use Accept: MIME-TYPE,*/*;q=0.1

	* raptor/raptor_www_curl.c (raptor_www_curl_fetch):
	append to slist right

	* raptor/raptor_general.c (raptor_parse_uri_with_connection):
	Send "Accept: MIME-TYPE ;*/*"
	to prefer the specified one rather than accept only that.

	* raptor/raptor.h: Added raptor_get_mime_type

	* raptor/raptor_general.c (raptor_parse_uri_with_connection):
	Set Accept header with mime type
	of this syntax if there is one

	* raptor/raptor_www.c (raptor_www_set_http_accept):
	Make accept value overwrite \0 from
	Accept:

	* raptor/configure.ac: make raptor.rdf

	* raptor/turtle_parser.y, raptor/raptor_www_libxml.c,
	raptor/raptor_parse.c, raptor/ntriples_parse.c: Fixes for c++

	* raptor/Makefile.am: added raptor.rdf.in

	* raptor/raptor.rdf.in: DOAP

2004-05-02  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_parser.y:
	Add xml_literal_datatype_uri to parser context.
	(raptor_turtle_parse_init,raptor_turtle_parse_terminate): use above
	(raptor_turtle_generate_statement): Use above to remove language
	from all literals except xml literals.

	* raptor/turtle_common.h:
	Add xml_literal_datatype_uri to parser context.

	* raptor/ntriples_parse.c:
	Add xml_literal_datatype_uri to parser context.
	(raptor_ntriples_parse_init,raptor_ntriples_parse_terminate): use
	above
	(raptor_ntriples_generate_statement): Use above to remove language
	from all literals except xml literals.

	* raptor/raptor_identifier.c (raptor_identifier_print):
	Use raptor_xml_literal_datatype_uri_string
	and save a string.

2004-04-29  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/rdfdump.c (main):
	Use raptor_free_memory to free memory allocated in libraptor.

	* raptor/raptor_www_libxml.c (raptor_www_libxml_fetch):
	Free content type using libxml's xmlFree
	since it was allocated there.

	* raptor/raptor_www_libxml.c, raptor/raptor_www_curl.c
	(raptor_www_libxml_fetch): Make headers for User-Agent: and/or
	Accept: if they were set in the raptor_www.

	* raptor/raptor_www.c (raptor_www_set_http_accept): Added.

	* raptor/raptor_internal.h: Added http_accept to raptor_www

	* raptor/raptor.h: Added raptor_www_set_http_accept

2004-04-28  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* ruby/README.txt: README.txt

	* ruby/test/test_serializer.rb, ruby/test/test_statement.rb,
	ruby/test/test_store.rb, ruby/test/test_uri.rb,
	ruby/lib/rdf/util.rb, ruby/lib/rdfs/class.rb,
	ruby/lib/rdfs/property.rb, ruby/lib/rdfs/rdfs_resource.rb,
	ruby/test/test_model.rb, ruby/test/test_node.rb,
	ruby/test/test_parser.rb, ruby/test/test_rdf.rb,
	ruby/test/test_rdfs_resource.rb, ruby/test/test_resource.rb,
	ruby/lib/rdf/parser.rb, ruby/lib/rdf/resource.rb,
	ruby/lib/rdf/serializer.rb, ruby/lib/rdf/statement.rb,
	ruby/lib/rdf/store.rb, ruby/lib/rdf/stream.rb,
	ruby/lib/rdf/uri.rb, ruby/lib/rdf/constants.rb,
	ruby/lib/rdf/convert_owl.rb, ruby/lib/rdf/convertfoaf.rb,
	ruby/lib/rdf/dc.rb, ruby/lib/rdf/foaf.rb, ruby/lib/rdf/model.rb,
	ruby/lib/rdf/node.rb, ruby/lib/rdf.rb, ruby/rdf-redland.gemspec,
	ruby/triples.rdf, ruby/ical.rdf: Import from rdf-redland-0.5.tgz
	from http://rubyforge.org/projects/ruby-rdf/

2004-04-27  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* Redland.i: Added output typemap for ruby returning char NULL.
	Added some more model api calls used by ruby-rdf

2004-04-25  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_node.c (librdf_node_get_blank_identifier): Assert typo.

2004-04-15  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c (raptor_guess_parser_name):
	use strrchr to find *last* .

2004-04-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_node.c (librdf_node_to_counted_string):
	Encode language and datatype for
	literal strings.

	* raptor/raptor_sequence.c (raptor_new_sequence): Zap sequence field.

	* raptor/raptor_xml_writer.c (raptor_xml_writer_cdata):
	Do not copy more bytes than allowed.

	* raptor/Makefile.am: Added raptor_expat.c

	* raptor/raptor_parse.c: Export some expat-only handlers:
	raptor_xml_unparsed_entity_decl_handler,
	raptor_xml_external_entity_ref_handler.
	(raptor_xml_parse_init): Do not call expat init code here.
	(raptor_xml_parse_start): Call new aptor_expat_init to initialise
	parser state.

	* raptor/raptor_internal.h: Added RAPTOR_XML_EXPAT only exports
	including raptor_expat_init prototype.

	* raptor/raptor_expat.c: raptor expat parser

2004-04-13  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor.h: Added xsd and owl namespace URIs

	* raptor/raptor_namespace.c (raptor_namespaces_init):
	Define xsd, owl when defaults is 2+

2004-04-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/Makefile.am: Apply local cppflags to building wrapper

	* librdf/Makefile.am:
	Apply local cppflags to AM_CFLAGS, for building tests

2004-04-11  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_parse.c:
	(raptor_xml_parse_start) Free expat/libxml contexts from an
	earlier parsing to ensure resetting of state

	* librdf/rdf_parser.c (main):
	Need to init node, concepts before parser.

	* TODO.html: parser features

	* Redland.i: set default args on librdf_model_load

	* python/test/test.py: test model.load

	* python/RDF.py (model.load): Added calling librdf_model_load

	* Redland.i: Updated to use librdf_test_error and
	librdf_test_warning for testing errors.

	* librdf/rdf_log.h, librdf/rdf_log.c
	(librdf_test_error,librdf_test_warning): Added for testing errors.

	* Redland.i, librdf/rdf_model.h: Added librdf_model_load

	* librdf/rdf_model.c (librdf_model_load):
	Added, using parser guessing via
	raptor_guess_parser_name if no name is given.

	* librdf/rdf_parser_raptor.c:
	Move raptor_new_parser to the init factory method rather than making
	a new one for each parsing.  Add a raptor_parser* rdf_parser field
	to the context structure.
	(librdf_parser_raptor_get_feature): Call raptor_get_feature if it is
	not known here.
	(librdf_parser_raptor_set_feature): Call raptor_set_feature.

	* raptor/raptor_stringbuffer.c
	(raptor_stringbuffer_prepend_string_common): Added
	(raptor_stringbuffer_prepend_counted_string,
	raptor_stringbuffer_prepend_string): Added, implemented by above
	internal function.
	(main): Added tests for prepending.

	* raptor/raptor.h: Add RAPTOR_API for newly exported functions.
	Add raptor_stringbuffer_prepend_counted_string,
	raptor_stringbuffer_prepend_string

	* raptor/raptor_stringbuffer.c: (main) printf arg

	* raptor/raptor_internal.h, raptor/raptor.h:
	Moved raptor_stringbuffer to public API

	* raptor/raptor_stringbuffer.c
	(raptor_stringbuffer_append_stringbuffer): Added.
	(main): Updated test code for
	raptor_stringbuffer_append_stringbuffer

2004-04-10  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c, raptor/raptor.h (raptor_guess_parser_name):
	Added new public class method.
	(raptor_new_parser_for_content): Now uses above.

	* raptor/raptor_internal.h, raptor/raptor.h:
	Move raptor_unicode_char_to_utf8, raptor_utf8_to_unicode_char to
	public API.

	* INSTALL.html: consistency with raptor instructions.
	update automake, autoconf minimums.

	* raptor/INSTALL.html: consistency with librdf instructions.
	update libxml versions.
	update automake, autoconf minimums.

	* raptor/NEWS.html: rewordings

	* raptor/TODO.html: parser guessing done

	* raptor/tests/Makefile.am: fix result codes for split off NFC warnings

	* raptor/tests/Makefile.am:
	Split off NFC warnings so they can fail noisily when glib isn't
	present to do the check.

	* raptor/NEWS.html: updated pre-1.3.0

	* raptor/rapper.1:
	Document -g/--guess flag to guess the parser to use from the
	identifier (URI or file name).

	* raptor/rdfdump.c:
	Added -g/--guess flag to use raptor_new_parser_for_content guessing
	the parser to use from the identifier (URI or file name).

	* raptor/turtle_parser.y, raptor/raptor_rss.c,
	raptor/raptor_parse.c, raptor/ntriples_parse.c: Added scoring
	factory method recognise_syntax for rdfxml, ntriples, rss, turtle
	parsers.

	* raptor/raptor_internal.h:
	Added parser scoring factory method recognise_syntax.

	* raptor/raptor_general.c (raptor_new_parser_for_content):
	Added, guessing which parser to
	instance using scoring factory method recognise_syntax.

	* raptor/raptor.h: Added raptor_new_parser_for_content

2004-04-10  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_sequence.c: cast for c++

2004-04-09  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_parse.c: Removed use of raptor_print_statement_detailed

	* raptor/raptor_internal.h:
	Removed raptor_print_statement_part_as_ntriples, made static

	* raptor/raptor.h: Deprecate raptor_print_statement_detailed

	* raptor/raptor_general.c (raptor_print_statement_detailed):
	Restored, was in raptor.h but useless.

	* raptor/raptor_general.c: dates, docucomments
	(raptor_print_statement_detailed): Deleted - never publically
	documented or used.

	* raptor/TODO.html: year

2004-04-09  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/LICENSE.html: year

	* librdf/rdf_uri.c, librdf/rdf_storage_tstore.h,
	librdf/rdf_storage_tstore.c, librdf/rdf_storage_mysql.h,
	librdf/rdf_storage_mysql.c, librdf/rdf_storage_list.h,
	librdf/rdf_storage_list.c, librdf/rdf_storage_hashes.h,
	librdf/rdf_storage_hashes.c, librdf/rdf_storage_file.c,
	librdf/rdf_storage.h, librdf/rdf_storage.c,
	librdf/rdf_serializer.c, librdf/rdf_query_triples.h,
	librdf/rdf_query_triples.c, librdf/rdf_query.h,
	librdf/rdf_query.c, librdf/rdf_parser.c, librdf/rdf_node.c,
	librdf/rdf_model_storage.h, librdf/rdf_model_storage.c,
	librdf/rdf_model.h, librdf/rdf_model.c, librdf/rdf_internal.h,
	librdf/rdf_hash.c, librdf/rdf_digest.c, librdf/rdf_concepts.c: Add
	world field to all LIBRDF_FATAL1 calls.  Add world parameter to
	all factory registrations.

	* librdf/rdf_log.h: Added more log facilities.

	* librdf/rdf_digest.h: Added world field

	* librdf/rdf_internal.h, librdf/rdf_query.c: zap LIBRDF_FATAL2

2004-04-08  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/Makefile.am:
	raptor_sequence_test needs to link with libraptor.la

	* raptor/turtle_parser.y:
	rename raptor_free_handler,raptor_print_handler -> as raptor_sequence...

	* raptor/raptor.h, raptor/raptor_internal.h:
	Move sequence class to public api.

	* raptor/raptor_sequence.c:
	rename raptor_free_handler,raptor_print_handler -> as raptor_sequence...
	(raptor_sequence_print_uri): Added.
	(raptor_sequence_set_print_handler): Added.

	* raptor/raptor_internal.h, raptor/raptor.h:
	Export raptor_vsnprintf public.

	* configure.ac: require raptor 1.3.0

	* librdf/rdf_serializer_rdfxml.c
	(librdf_serializer_rdfxml_raptor_error_handler): Just pass message
	on to librdf_log_simple as a single string, don't add a prefix.

	* librdf/rdf_parser_raptor.c:
	(librdf_parser_raptor_error_handler,
	librdf_parser_raptor_warning_handler): Just pass message on to
	librdf_log_simple with locator, don't add a prefix.

	* librdf/rdf_storage_mysql.c, librdf/rdf_storage_file.c,
	librdf/rdf_query_triples.c, librdf/rdf_hash_bdb.c: Replace
	librdf_error and some LIBRDF_ERROR2 with librdf_log.

	* librdf/redland.h: Compiling with Redland requires raptor.h

	* librdf/librdf.h: Use rdf_log.h

	* librdf/rdf_init.h: Use rdf_log structs inside world.
	Added librdf_world_set_logger.
	Deprecated older internal librdf_error/librdf_warning.

	* librdf/rdf_init.c: Moved error/warning code to rdf_log.c/.h
	(librdf_world_set_logger): Added.

	* librdf/Makefile.am: Added rdf_log.c rdf_log.h

	* librdf/rdf_log.c, librdf/rdf_log.h: RDF logging

	* Redland.i:
	Add typemap for ruby inStrOrNull for certain functions that can take
	an optional string.  Additionally, add default parameters for those
	functions: librdf_new_node_from_literal,
	librdf_new_node_from_typed_literal and
	librdf_new_node_from_blank_identifier.

2004-04-06  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_parser.y (turtle_parse): Remove un-necessary cast.

	* raptor/turtle_parser.y (turtle_parse): Free lexer

2004-04-05  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/rdfdump.c:
	Added HELP_PAD to format long help description over multiple lines.

	* raptor/TODO.html: docs

2004-03-30  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/turtle/test-00.out: Updated base uri

	* raptor/tests/turtle/Makefile.am: Added rdfq-results

	* raptor/tests/turtle/rdfq-results.out,
	raptor/tests/turtle/rdfq-results.ttl: RDF Query result set example
	from
	http://www.w3.org/2003/03/rdfqr-tests/recording-query-results.html

	* using.html: fabl words

	* using.html: Added Fabl

2004-03-27  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c, raptor/turtle_parser.y, raptor/rdfdump.c:
	casts for C++

	* utils/Makefile.am: redland-db-upgrade doesn't take gnu opts

	* tcl/Makefile.am: automake fixes for 1.7+ using newer macros

	* configure.ac:
	Do not -Wall automake, override is needed in language dirs.
	List specific warnings.

	* ruby/Makefile.am, python/Makefile.am, php/Makefile.am,
	examples/Makefile.am, csharp/Makefile.am: automake fixes for 1.7+
	using newer macros

	* NEWS.html: Skeleton 0.9.17 news

	* configure.ac, autogen.sh: Use some AM_INIT_AUTOMAKE options.
	Require automake1.7, which requires autoconf 2.54

	* redland-src-config.in, redland-config.in:
	Support --help, emit to stdout and exit 0.

	* raptor/NEWS.html: skelton 1.3.0 news

	* raptor/configure.ac, raptor/autogen.sh:
	Use some AM_INIT_AUTOMAKE options.
	Require automake1.7, which requires autoconf 2.54

	* raptor/examples/Makefile.am:
	Drop $(shell .. ) which is not portable between makes

	* raptor/raptor-src-config.in, raptor/raptor-config.in:
	emit --help usage to stdout

	* raptor/raptor-src-config.in, raptor/raptor-config.in:
	Support --help and exit 0.

2004-03-26  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/libraptor.3: words

	* raptor/rapper.1: Document -f

	* raptor/TODO.html: bug was libxml2 not me

	* TODO.html: python RFE __nonzero__

	* raptor/tests/Makefile.am: Add bad-21

	* raptor/tests/bad-21.rdf:
	Check non-namespaced attributes on a property are reported

	* raptor/raptor_parse.c (raptor_xml_start_element_handler):
	Check element, attributes for
	non-namespaces once we know we are in rdf processing.
	Check all named attributes for lack of namespace, error and zap
	if found.
	(raptor_process_property_attributes): Skip any deleted attributes.

2004-03-25  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/Makefile.am: Added warn-05, warn-06

	* raptor/tests/warn-05.out, raptor/tests/warn-06.out,
	raptor/tests/warn-05.rdf, raptor/tests/warn-06.rdf: Check for
	warning for unknown rdf namespaced property element, attributes

	* raptor/raptor_parse.c (raptor_process_property_attributes):
	Generate an error for forbidden
	rdf names, warning for unknown rdf names.

	* raptor/raptor_parse.c:
	Merged rdf_attr_info into rdf_syntax_terms_info.
	Now we can check for unknown rdf: names
	(raptor_forbidden_nodeElement_name,
	raptor_forbidden_propertyElement_name,
	raptor_forbidden_propertyAttribute_name): Return -1 on unknown name.
	(raptor_start_element_grammar): Generate an error for forbidden
	rdf names, warning for unknown rdf names.

	* raptor/tests/Makefile.am: Added warn-04

	* raptor/tests/warn-04.out, raptor/tests/warn-04.rdf:
	Check for warning for unknown rdf namespaced node element

	* raptor/tests/turtle/Makefile.am, raptor/tests/Makefile.am:
	fix grep for Warning output

	* docs/stylesheet.css: no size

	* raptor/raptor_general.c, raptor/raptor.h:
	Added raptor_free_memory to dealloc memory returned by raptor
	functions - some systems need this due to having multiple heaps.

	* raptor/raptor_general.c (raptor_default_generate_id_handler): doh

	* raptor/raptor_general.c (raptor_default_generate_id_handler):
	Rework not to use tmpid before
	initialising it.

	* raptor/raptor_general.c (main): Free returned uri

	* raptor/raptor.h: Added raptor_feature_from_uri

	* raptor/Makefile.am: Added raptor_general_test

	* raptor/raptor_general.c (raptor_feature_from_uri):
	Turn a feature URI into a feature number.
	(main): Added, testing feature enumerations.

	* raptor/rdfdump.c: note feature values in -f help

	* raptor/rdfdump.c: More help message tidying.

	* raptor/rdfdump.c:
	Alter HELP_TEXT macro so short arg isn't auto-quoted.
	Use this to add short option options arg to help.

2004-03-24  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c (raptor_default_generate_id_handler):
	Don't bump default genid
	counter when a user_bnodeid is present.

	* raptor/rdfdump.c:
	Allow setting feature optional values -f NAME=VALUE (integer).

	* raptor/raptor_general.c, raptor/raptor.h:
	Use raptor_feature type for enumeration calls.

	* raptor/raptor_general.c: Tidy feature labels

	* raptor/rdfdump.c: Tidy -f help message.

	* raptor/rdfdump.c:
	Re-ordered long_options to be alphabetical by option char.
	Added -f/--feature FEATURE to set a parser feature.
	With the value 'help', lists them all using raptor_features_enumerate.

	* raptor/raptor.h: Added raptor_get_feature, raptor_features_enumerate.
	raptor_set_feature gets a return value.

	* raptor/raptor_general.c (raptor_set_feature):
	Delete docs, now has an API.  Return a failure value.
	raptor_features_list - static added.
	(raptor_features_enumerate): Added, to allow returning
	of parser feature name, URI and/or label.
	(raptor_get_feature): Added.

	* TODO.html: word

2004-03-23  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/TODO.html: Add turtle use of raptor_generate_id

	* raptor/turtle_parser.y (blank):
	Use raptor_generate_id when a blank identifier name is
	given, to allow application to change it.

2004-03-21  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/tests/turtle/test-10.out,
	raptor/tests/turtle/test-09.out, raptor/turtle_parser.y: Make
	Turtle integers emit xsd:integer

2004-03-19  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_parse.c: Twice.

	* raptor/raptor_parse.c: Remove FIXME for other rdf:parseType
	values - just fall through to Literal

	* raptor/raptor_parse.c: FIXME not relevant.

	* raptor/ntriples_parse.c (raptor_ntriples_generate_statement):
	Kill a FIXME, fail with an error on bad rdf:_n property.

	* raptor/tests/Makefile.am: Added bad-06.nt

	* raptor/tests/bad-06.nt: bad rdf:_n in ntriples

2004-03-18  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_parser.y: Added INTEGER_LITERAL.
	Turn it into a xsd:nonNegativeInteger

	* raptor/turtle_lexer.l: Added INTEGER_LITERAL.

	* raptor/tests/turtle/Makefile.am: Added test-09 test-10

	* raptor/tests/turtle/test-09.out,
	raptor/tests/turtle/test-09.ttl, raptor/tests/turtle/test-10.out,
	raptor/tests/turtle/test-10.ttl: Integer literal tests

	* raptor/tests/Makefile.am, raptor/Makefile.am:
	Ensure rapper is up-to-date and built before tests are run.

2004-03-16  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* php/test.php:
	Add some PHP 4.3 compatible defines, and use them to find the right
	shared lib prefix, suffixes to load.

	* php/php.ini: Use False for bool

	* php/Makefile.am: try php -c .

	* librdf/rdf_parser_raptor.c, librdf/rdf_parser.c: docs

2004-03-15  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* php/Makefile.am:
	Use -c php.ini rather than -d extension_dir=. which might prevent
	loading (wrong) global configuration.

	* raptor/tests/warn-03.out, raptor/tests/warn-03.rdf:
	Added warn-03 warning not dieing on NFC in XML literals

	* raptor/tests/Makefile.am: Added warn-03

	* raptor/raptor_parse.c (raptor_end_element_grammar):
	For NFC problems in an XML literal,
	take notice of feature_non_nfc_fatal which defaults to warning,
	rather than given an error.

2004-03-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/redlandtest.py: Added testParseStringAsStream

	* python/RDF.py (Model.add_statements): Use statement_stream._stream.

	* python/RDF.py (parser.parse_string_as_stream):
	Add base_uri to example - it's required.

2004-03-10  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/redland.pc.in: Use -lrdf (patch from Curtis Hovey)

2004-02-26  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* redland-config.in: Use LIBRDF_VERSION_DECIMAL

	* configure.ac: Subsitute LIBRDF_VERSION_DECIMAL

	* raptor/tests/turtle/Makefile.am: Added bad-04.ttl

	* raptor/tests/turtle/bad-04.ttl: Check , in collection items fails

	* raptor/tests/turtle/test-07.ttl: Remove , between items - forbidden.

	* raptor/turtle_parser.y (objectList):
	Remove optional commas for triple objects.
	(itemList): Added with no commas.
	(collection): Use itemList not objectList.

	* raptor/tests/turtle/Makefile.am: remove test-09.ttl

	* raptor/tests/turtle/test-09.out, raptor/tests/turtle/test-09.ttl:
	Comma is required or not in collections, not optional

2004-02-24  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor.spec.in: Export library la files

	* raptor/turtle_parser.y (objectList):
	Allow optional commas in lists of objects - such as in
	all triple objects and collections.

	* raptor/tests/turtle/test-09.out, raptor/tests/turtle/test-09.ttl:
	Added test for optional comms in a collection

	* raptor/tests/turtle/Makefile.am: Added test-09.ttl

	* configure.ac: Bumped version to 0.9.17

	* Snapshotted redland_0_9_16 for 0.9.16 release (on branch
	redland_0_9_15-patches)

	* RELEASE.html, NEWS.html:
	Updated to 0.9.16 (from CVS branch redland_0_9_15-patches)

	* librdf/librdf.h, raptor/raptor.h: Add stdio.h

2004-02-23  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* RELEASE.html, NEWS.html: Updates for 0.9.16

	* configure.ac: Bumped version to 0.9.16

	* raptor/raptor.h: Add stdio.h

	* librdf/rdf_uri.h: Remove #include <rdf_digest.h>
	Make librdf_uri_get_digest internal.

	* librdf/rdf_node.h: Make librdf_node_get_digest internal.

	* librdf/librdf.h: Add stdio.h

	* redland-src-config.in: Make --run not discard spaces in arguments.

	* redland-src-config.in: Don't destroy whitespace in args with --run

	* librdf/rdf_uri.h:
	Remove include rdf_digest.h - an internal header, should not be called
	from a public one.
	Make librdf_uri_get_digest internal.

	* librdf/rdf_node.h: Make librdf_node_get_digest internal.

2004-02-19  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/n3_lexer.l, raptor/turtle_lexer.l (main):
	Don't re-reset the scanner to it's address.

	* raptor/n3_lexer.l, raptor/turtle_lexer.l: Remove RAPTOR_IN_REDLAND

	* raptor/turtle_parser.y (main): Use lineno.

	* raptor/turtle_parser.y: comment

	* INSTALL.html: No expat shipped.

	* INSTALL.html: Try to improve --with-LANGUAGE args docs

2004-02-16  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/RDF.py (Node.__init__): Use ._reduri for datatype uri arg

2004-02-02  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* perl/Makefile.am: fix test-perl

	* perl/Makefile.am: delete first test-perl

	* Redland.i (librdf_call_perl_message):
	Remove ENTER / LEAVE from perl - since
	swig now undefines ENTER.
	Add %newobject for all constructors and methods returning new
	objects - all returning librdf_stream, librdf_biterator,
	librdf_node.

	* docs/Makefile.am: Add api.html and fragments

	* docs/api.html.in: Skeleton html API manual

	* librdf/rdf_stream.c, librdf/rdf_storage_mysql.c,
	librdf/rdf_parser_raptor.c, librdf/rdf_node.c, librdf/rdf_model.c,
	librdf/rdf_iterator.c, librdf/rdf_init.c, librdf/rdf_heuristics.c:
	Docucomment fixes - missing args, renamed args.

	* docs/kernel-doc: Update to kernel-doc 2003-12-18

2004-02-01  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_stream.c, librdf/rdf_statement.c,
	librdf/rdf_iterator.c: Note explicitly that iterator/stream return
	SHARED pointers to the current object(or statement), context node

2004-01-31  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* configure.ac: Bumped version to 0.9.16

	* Snapshotted redland_0_9_15 for 0.9.15 release
	
	* redland-src-config.in: add raptor-config libs dir if building
	against system raptor

	* redland-src-config.in:
	Set library paths search, don't delete any existing ones.

	* tcl/Makefile.am ruby/Makefile.am, python/Makefile.am,
	php/Makefile.am, perl/Makefile.am, java/Makefile.am,
	csharp/Makefile.am: Use redland-src-config --run COMMAND to run
	test programs with the shared libraries built in the source tree.

	* redland-src-config.in:
	Add --run COMMAND to run programs with the shared libraries
	built in the source tree.

	* librdf/rdf_parser_raptor.c (librdf_parser_raptor_constructor):
	Use raptor_syntaxes_enumerate.

	* python/Makefile.am: PYTHON_INCLUDES

	* configure.ac: Improve python includes, libs checking.
	Report what's found.

2004-01-30  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* utils/Makefile.am, raptor/Makefile.am: deps

	* raptor/fix-groff-xhtml: words

	* raptor/rapper.1: fix changelog

	* raptor/Makefile.am: Make rapper.html

	* raptor/fix-groff-xhtml: Fix to strict

	* utils/Makefile.am: Use fix-groff-xhtml in the raptor src

	* librdf/rdf_storage_tstore.c: Switch to use option database, not db.

	* utils/Makefile.am: Added rdfproc.html fix-groff-xhtml

	* utils/rdfproc.1: fix storage args urls

	* raptor/rapper.1: urls

	* docs/Makefile.am: Added storage.html

	* librdf/rdf_hash_bdb.c (librdf_hash_bdb_open):
	Check identifier is not NULL.

	* librdf/redland.spec.in: Build with mysql, without threestore,
	  Update deps, perl >=5.8.0, python >=2.2.0, require Raptor 1.2.0+

	* librdf/redland.spec.in: Fix install for python, remove setup.py

	* python/setup.cfg, python/setup.py: Junk distutils

	* python/Makefile.am: Junk distutils.

	* configure.ac: Get python_include, python_lib and substitute.

2004-01-29  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* java/org/librdf/redland/Model.java (findStatements):
	Added with context_node.
	(getContexts): Added.

	* docs/redland.pod: Updated
	Model: Added librdf_model_find_statements_in_context,
	librdf_model_find_statements_with_options, librdf_model_get_contexts,
	librdf_model_get_feature, librdf_model_set_feature.
	Parser: Changed librdf_parser_get_feature, librdf_parser_set_feature
	args to nodes.
	Serializer: Added, was missing.

2004-01-25  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* utils/rdf-digest.c, utils/rdf-load.c: removed rdf-digest rdf-load

	* utils/Makefile.am: Remove rdf-load rdf-digest

	* librdf/rdf_storage_file.c (librdf_storage_file_init): Cast for URI.

	* librdf/rdf_storage_hashes.c
	(librdf_storage_hashes_get_contexts_get_method): World in error arg.

	* librdf/rdf_storage_list.c
	(librdf_storage_list_get_contexts_get_method): World in error arg.

	* configure.ac: Added --disable-assert and --disable-assert-messages to
	prevent (default) compilation of assertion code and outputing
	of messages when the assertions fail.

	* librdf/rdf_internal.h:
	Made assertions print out, but not abort in standard compile.
	Added LIBRDF_DISABLE_ASSERT_MESSAGES to prevent the output code.
	Added LIBRDF_DISABLE_ASSERT to prevent the assertions entirely.

	* librdf/rdf_storage_tstore.c: Use storage usage tracking.
	(librdf_storage_tstore_serialise,
	librdf_storage_tstore_serialise_finished): Add/remove storage usage.
	(librdf_storage_tstore_find_statements,
	librdf_storage_tstore_find_finished): Add/remove storage usage.

	* librdf/rdf_storage_mysql.c: Use storage usage tracking.
	(librdf_storage_mysql_find_statements_with_options,
	librdf_storage_mysql_find_statements_in_context_finished): Add/remove
	storage usage.
	(librdf_storage_mysql_get_contexts,
	librdf_storage_mysql_get_contexts_finished): Add/remove storage usage.

	* librdf/rdf_storage_list.c: Use storage usage tracking.
	(librdf_storage_list_serialise,
	librdf_storage_list_serialise_finished): Add/remove storage usage.
	(librdf_storage_list_context_serialise,
	librdf_storage_list_context_serialise_finished): Add/remove
	storage usage.
	(librdf_storage_list_get_contexts_finished,
	librdf_storage_list_get_contexts): Add/remove storage usage.

	* librdf/rdf_storage_hashes.c: Use storage usage tracking.
	(librdf_storage_hashes_serialise_common,
	librdf_storage_hashes_serialise_finished): Add/remove storage usage.
	(librdf_storage_hashes_node_iterator_finished,
	librdf_storage_hashes_node_iterator_create): Add/remove storage usage.
	(librdf_storage_hashes_context_serialise,
	librdf_storage_hashes_context_serialise_finished): Add/remove
	storage usage.
	(librdf_storage_hashes_get_contexts,
	librdf_storage_hashes_get_contexts_finished): Add/remove storage
	usage.

	* perl/lib/RDF/Redland/Storage.pm, perl/lib/RDF/Redland/Model.pm
	(DESTROY): Remove debug message fixme.

	* librdf/rdf_model_storage.c (librdf_model_storage_create,
	librdf_model_storage_destroy): Add and release a reference to the
	used storage.

	* librdf/rdf_storage.h: Add usage tracking to librdf_model.
	Added librdf_storage_add_reference, librdf_storage_remove_reference

	* librdf/rdf_storage.c: Add usage tracking.
	(librdf_new_storage_from_storage,librdf_new_storage_from_factory): Set
	usage to 1 on creation.
	(librdf_free_storage): Decrement usage, free if 0.
	(librdf_storage_add_reference,librdf_storage_remove_reference): Added.
	(librdf_storage_stream_to_node_iterator_finished,
	librdf_storage_node_stream_to_node_create); Add storage usage tracking.

	* librdf/rdf_model.h: Add usage tracking to librdf_model.
	Added librdf_model_add_reference, librdf_model_remove_reference

	* librdf/rdf_model.c: Add usage tracking.
	(librdf_new_model_with_options,librdf_new_model_from_model): Set
	usage to 1 on creation.
	(librdf_free_model): Decrement usage, free if 0.
	(librdf_model_add_reference,librdf_model_remove_reference): Added.

	* raptor/raptor_general.c (raptor_delete_parser_factories):
	Free alias if it was set.

2004-01-24  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* configure.ac: RAPTOR_MIN_VERSION=1.2.0

	* Makefile.am: Add Changelog.1-3 to dist

	* raptor/rdfdump.c:
	Don't print (default) when listing valid args for -i

	* raptor/rdfdump.c:
	Use raptor_syntax_name_check to check name; don't make/destroy a
	parser.

	* raptor/raptor_general.c (raptor_syntax_name_check):
	Added, to check names.

	* raptor/raptor.h: Added raptor_syntax_name_check

	* raptor/rdfdump.c: Make -i try to make a parser, don't hardcode names.

	* raptor/rdfdump.c: Use raptor_syntaxes_enumerate in -i error

	* raptor/rdfdump.c: Use raptor_syntaxes_enumerate in usage -i help

	* raptor/rapper.1: Updated to mention Turtle.

	* raptor/configure.ac: Bumped version to 1.3.0

	* raptor/libraptor.3: Updated for 1.2.0

	* librdf/rdf_storage_mysql.c:
	Change schema. Table Literals, column Language remove default ''

	* librdf/rdf_storage_mysql.c:
	Change schema. Table Literals, column Language varchar(6) to text.

2004-01-22  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_model.c (librdf_model_get_source,
	librdf_model_get_arc, librdf_model_get_target): Fail if iterator
	returns NULL.

	* raptor/configure.ac: words

	* raptor/configure.ac:
	Use AC_PROG_LEX and handle when there is no lex or flex gracefully.
	AM_PROG_LEX set LEX to a value that caused odd configure output.

2004-01-21  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* configure.ac: If /sw/bin, add to END of PATH for OSX

2004-01-20  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* utils/rdfproc.c:
	Added match command, doing a match-substring search using the model
	find_statements with that option.

	* librdf/rdf_storage_mysql.c: Literal matching seems to be working.

	* librdf/rdf_storage_mysql.c:
	Added basic (LIKE) literal searching when option match-substring=true

	* librdf/rdf_storage_mysql.c
	(librdf_storage_mysql_find_statements_with_options): Added, making
	this the general query method renamed from
	librdf_storage_mysql_find_statements_in_context, not using the
	options just yet.

	* librdf/rdf_model_storage.c
	(librdf_model_storage_find_statements_with_options): Added,
	passing it through to the model storage.

	* librdf/rdf_model.c (librdf_model_find_statements_with_options):
	Added, optional.

	* librdf/rdf_model.h: Added factory method find_statements_with_options
	Added librdf_model_find_statements_with_options
	Added option LIBRDF_MODEL_FIND_OPTION_MATCH_SUBSTRING_LITERAL

	* librdf/rdf_storage.c (librdf_storage_find_statements_with_options):
	Added, optional.

	* librdf/rdf_storage.h:
	Added factory method find_statements_with_options
	Added librdf_storage_find_statements_with_options

	* raptor/configure.ac:
	Updated output files check from n3/ntriples plus to turtle

	* raptor/turtle_parser.y, raptor/raptor_rss.c,
	raptor/raptor_parse.c, raptor/ntriples_parse.c:
	Update to use raptor_parser_register_factory alias argument
	to register any old or alternate names.

	* raptor/raptor_internal.h: Add alias field to raptor_parser_factory_s.
	Add alias argument to raptor_parser_register_factory prototype.

	* raptor/raptor_general.c (raptor_parser_register_factory,
	raptor_get_parser_factory): Added an
	alias argument, used to register a alternate name which is
	never used or returned in parser enumerations.

	* raptor/examples/grapper.c:
	Added a tooltip for the errors/warnings output box.

	* raptor/examples/grapper.c: Use G_TYPE_INT for column 1 of errors

	* raptor/examples/grapper.c:
	Added errors/warnings box, updated with results of parsing.

	* raptor/Makefile.am: Added ChangeLog.1

2004-01-19  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c:
	Define raptor_system_malloc, raptor_system_free

	* raptor/raptor_internal.h: RAPTOR_... not LIBRDF_

	* raptor/raptor_utf8.c (raptor_utf8_is_nfc): Use SYSTEM_FREE

	* raptor/raptor_internal.h: Define SYSTEM_MALLOC, SYSTEM_FREE

2004-01-18  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/turtle_parser.y: fix double free of first_identifier

	* raptor/turtle_parser.y: Collections generating triples.

	* raptor/turtle_common.h: Add nil/first/rest_uri fields

	* raptor/tests/turtle/test-07.out: Updated as a collection test result.

	* raptor/tests/turtle/Makefile.am: Added test-08

	* raptor/tests/turtle/test-08.out,
	raptor/tests/turtle/test-08.ttl, raptor/tests/turtle/test-07.ttl:
	collection test

	* raptor/turtle_lexer.l: Added '(' and ')' for collections.

	* raptor/turtle_parser.y:
	Added collection grammar parts, triples not right yet.

	* raptor/raptor_identifier.c (raptor_copy_identifier):
	Copy literal languages correctly.

	* raptor/tests/turtle/test-00.out,
	raptor/tests/turtle/Makefile.am, raptor/tests/Makefile.am,
	raptor/turtle_parser.y, raptor/turtle_lexer.l,
	raptor/turtle_common.h, raptor/raptor_internal.h,
	raptor/raptor_general.c, raptor/configure.ac, raptor/Makefile.am:
	N-Triples Plus to Turtle, n3_ in filenames to turtle_, .ntp to .ttl

	* raptor/rdfdump.c: indenting

	* raptor/rdfdump.c: Allow turtle, don't document ntriples-plus

	* raptor/n3_parser.y, raptor/turtle_parser.y:
	Register under the name turtle

2004-01-17  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* python/RDF.py: Added FileStorage

	* csharp/Makefile.am: touch stamp after build

	* csharp/Makefile.am: Update clean

	* csharp/Makefile.am: Update fakery

	* perl/Makefile.PL: Stop perl linking to destdir

	* python/setup.py: Tidy, add more libraries

	* utils/rdfproc.c: Use librdf_storage_enumerate in help

	* librdf/rdf_storage_tstore.c, librdf/rdf_storage_mysql.c,
	librdf/rdf_storage_list.c, librdf/rdf_storage_hashes.c,
	librdf/rdf_storage_file.c: Updated to add store labels.

	* librdf/rdf_storage.h: Added label to librdf_storage_factory
	librdf_storage_register_factory gains label arg
	Added librdf_storage_enumerate prototype.

	* librdf/rdf_storage.c: Added labels to factory.
	(librdf_storage_register_factory): Added label arg.
	(librdf_storage_enumerate): Added, to get basic store info.

	* librdf/rdf_storage_file.c (librdf_storage_file_size):
	For consistency, use the model call.

	* librdf/rdf_storage.h, librdf/rdf_storage.c:
	Added librdf_init_storage_file

	* librdf/Makefile.am: Added rdf_storage_file.c

	* utils/rdfproc.c: Some C++ casts.
	Init rc correctly.
	Correct indenting to follow logic near CMD_SERIALIZE.

	* librdf/rdf_storage_file.c: Persistent store in file (r/w) and uri (r)

	* librdf/rdf_serializer.h: Re-export librdf_serializer_serialize_model

2004-01-16  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_serializer.c (librdf_serializer_serialize_model):
	re-export

	* librdf/rdf_serializer.c (librdf_serializer_serialize_model):
	static, internal.

	* librdf/rdf_serializer.h:
	Do not export librdf_serializer_serialize_model

2004-01-15  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* java/Makefile.am:
	More OSX-only things; the JNI libs install with a different name!

	* python/RDF.py (Model.get_contexts): Fix Iterator call.

	* java/Makefile.am:
	Add DYLD_LIBRARY_PATH to try to make 'make check' work on OSX.

	* configure.ac: Add OSX dirs to JDK search guesses

	* ruby/Makefile.am: Try to find the right libruby another way

	* librdf/rdf_storage_hashes.c (librdf_storage_hashes_get_contexts):
	Added, implementing get_contexts for hashes storage implementation.

	* python/RDF.py: Export NS class.
	(Parser. parse_string_as_stream): Promote string URI to a Redland Uri.

2004-01-14  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_serializer_raptor.c
	(librdf_serializer_print_statement_as_ntriple): Emit literal
	datatype URI in N-Triples encoding.

	* librdf/rdf_serializer_raptor.c
	(librdf_serializer_print_statement_as_ntriple): break

	* librdf/rdf_serializer_raptor.c
	(librdf_serializer_print_statement_as_ntriple): Emit subject and
	predicate URIs in N-Triples encoding.  Add some checks.

	* librdf/rdf_serializer_raptor.c
	(librdf_serializer_print_statement_as_ntriple): Emit URIs in UTF-8

	* librdf/rdf_uri.c, librdf/rdf_storage_hashes.c,
	librdf/rdf_storage.c, librdf/rdf_statement.c,
	librdf/rdf_serializer.c, librdf/rdf_query.c,
	librdf/rdf_parser_raptor.c, librdf/rdf_parser.c,
	librdf/rdf_node.c, librdf/rdf_model.c, librdf/rdf_internal.h,
	librdf/rdf_hash_bdb.c, librdf/rdf_hash.c, librdf/rdf_digest.c:
	LIBRDF_DEBUG* lose their function arg

	* configure.ac: help message consistency again

	* configure.ac: help message consistency.

	* librdf/rdf_storage_mysql.c, librdf/rdf_storage_list.c,
	librdf/rdf_storage_hashes.c, librdf/rdf_parser_raptor.c: Various
	casts for C++ (g++) to be happier.

	* raptor/raptor_xml_writer.c, raptor/raptor_uri.c,
	raptor/raptor_rss.c, raptor/raptor_qname.c, raptor/raptor_parse.c,
	raptor/raptor_namespace.c, raptor/raptor_internal.h,
	raptor/raptor_general.c, raptor/ntriples_parse.c: RAPTOR_ERROR*
	and RAPTOR_FATAL* lose their function arg, using __func__

	* php/redland_wrap.c.patch:
	Add librdf_php_world_finish() to PHP_MSHUTDOWN_FUNCTION(redland)

	* php/test.php:
	Remove world startup/shutdown, now handled by the module.
	use $world=librdf_php_get_world()

	* php/Makefile.am: Ensure the .orig is around for patching.

	* Redland.i: For PHP, initialise the world when the module starts up.
	Add librdf_serializer definition.

	* examples/Makefile.am: Restore example4

	* librdf/rdf_uri.c, librdf/rdf_stream.c,
	librdf/rdf_storage_tstore.c, librdf/rdf_storage_mysql.c,
	librdf/rdf_storage_list.c, librdf/rdf_storage_hashes.c,
	librdf/rdf_storage.c, librdf/rdf_statement.c,
	librdf/rdf_serializer_rdfxml.c, librdf/rdf_serializer.c,
	librdf/rdf_query.c, librdf/rdf_parser_raptor.c,
	librdf/rdf_parser.c, librdf/rdf_node.c, librdf/rdf_model.c,
	librdf/rdf_list.c, librdf/rdf_internal.h,
	librdf/rdf_hash_memory.c, librdf/rdf_hash_bdb.c,
	librdf/rdf_hash.c, librdf/rdf_digest.c, librdf/rdf_concepts.c:
	LIBRDF_ERROR* and LIBRDF_FATAL* lose their function arg

	* librdf/rdf_serializer.c, librdf/rdf_parser.c, librdf/rdf_storage.c:
	Add a bunch of LIBRDF_ASSERT* for object pointers.

	* librdf/rdf_node.c (librdf_node_get_literal_value_is_wf_xml):
	Only check non-NULL
	datatype URIs.

	* librdf/rdf_node.c (librdf_new_node_from_blank_identifier):
	Removed assertion, can be NULL.

	* librdf/rdf_model.c:
	Add a bunch of LIBRDF_ASSERT* for object pointers.

	* librdf/rdf_internal.h: fix macros again for not debugging.

	* librdf/rdf_internal.h: fix macros for not debugging.

	* librdf/rdf_statement.c:
	Add a bunch of LIBRDF_ASSERT* for object pointers.

	* librdf/rdf_internal.h: Assert macros tweaks.

	* librdf/rdf_node.c, librdf/rdf_uri.c:
	Add a bunch of LIBRDF_ASSERT* for object pointers.

	* librdf/rdf_internal.h (LIBRDF_ASSERT_RETURN, LIBRDF_ASSERT_OBJECT_POINTER_RETURN, LIBRDF_ASSERT_OBJECT_POINTER_RETURN_VALUE):
	Added macros.
	(LIBRDF_ERROR1,LIBRDF_ERROR2,LIBRDF_ERROR3,LIBRDF_FATAL1,LIBRDF_FATAL2):
	Use ANSI C99 __func__ rather than the function arg, renamed them to
	"notused" for now.

	* examples/example4.c: Code now demonstrates serializing.

	* librdf/rdf_uri.c (librdf_new_uri):
	Return NULL if string is NULL or empty (0 length).

	* raptor/raptor_general.c (raptor_finish):
	Remove direct call of raptor_terminate_parser_rdfxml

	* raptor/raptor_parse.c (raptor_xml_parse_finish_factory): Renamed from
	raptor_terminate_parser_rdfxml and now static.

	* raptor/raptor_internal.h: finish_factory returns void

	* raptor/raptor_internal.h:
	Added finish_factory factory cleanup method.
	Removed raptor_terminate_parser_rdfxml.

	* raptor/raptor_general.c (raptor_delete_parser_factories):
	Free mime type, URI string.  Call
	new finish_factory factory method.

	* librdf/rdf_init.c (librdf_free_world, librdf_world_open):
	Add raptor dependency notes.

2004-01-13  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* java/org/librdf/redland/Serializer.java,
	java/org/librdf/redland/Parser.java,
	java/org/librdf/redland/Model.java: Updated
	Model/Parser/Serializer get/setFeature methods to use Node not
	String.

	* librdf/Makefile.am: Add LIBRDF_EXTERNAL_CPPFLAGS for rdf_uri_test

	* utils/Makefile.am: Add LIBRDF_EXTERNAL_CPPFLAGS/LIBS

	* php/redland_wrap.c.patch: offsets

	* python/RDF.py (Model.find_statements): Add optional context arg.

	* perl/lib/RDF/Redland/Model.pm (find_statements):
	Add optional CONTEXT arg and call
	librdf_model_find_statements_in_context if given.

	* Redland.i: Added librdf_model_find_statements_in_context
	Added librdf_model_get_feature, librdf_model_set_feature.
	Adjust librdf_serializer_get_feature,
	librdf_serializer_set_feature to use librdf_node not strings.

	* librdf/rdf_serializer.h, librdf/rdf_serializer.c:
	Adjust librdf_serializer_get_feature,
	librdf_serializer_set_feature to use librdf_node not strings.

	* perl/lib/RDF/Redland/Model.pm: Added contexts method.

	* python/RDF.py (Model): Added get_contexts

	* Redland.i: Added librdf_model_get_contexts

	* python/RDF.py (Model): Added get_feature, set_feature
	(Parser): Updated get_feature, set_feature for using node values.

	* perl/lib/RDF/Redland/Model.pm: (feature) Added

	* perl/Makefile.PL:
	Add CFLAGS to dynamic_lib to get -g when it is enabled.

	* perl/Makefile.PL: CORE_PACKAGE must be in main namespace

	* perl/lib/RDF/Redland/Parser.pm (feature): Use/return nodes.

	* Redland.i:
	Adjust librdf_parser_get_feature, librdf_parser_set_feature to use
	librdf_node not strings.

	* utils/rdfproc.c: Check contexts return value.
	Tidy error, warning count nodes, uris.

	* librdf/rdf_storage_mysql.c (librdf_storage_mysql_get_feature):
	Added, to return contexts always.

	* librdf/rdf_storage_list.c (librdf_storage_list_get_feature):
	Added, to return contexts or not.

	* librdf/rdf_storage_hashes.c (librdf_storage_hashes_get_feature):
	Added, to return contexts or not.

	* utils/rdfproc.c:
	Use librdf_model_get_feature to find out if contexts are supported.

	* librdf/rdf_model_storage.c (librdf_model_storage_set_feature):
	Added, calling librdf_storage_set_feature

	* librdf/rdf_model_storage.c (librdf_model_storage_get_feature):
	Added, calling librdf_storage_get_feature

	* librdf/rdf_storage.h:
	Added storage methods, factory methods get_feature, set_feature now
	with librdf_uri* for feature property name, librdf_node* for values.

	* librdf/rdf_storage.c (librdf_storage_get_feature,librdf_storage_set_feature):
	Added

	* librdf/rdf_model.c (librdf_model_get_feature,librdf_model_set_feature):
	Added

	* librdf/rdf_model.h:
	Added parser methods, factory methods get_feature, set_feature now
	with librdf_uri* for feature property name, librdf_node* for values.

	* librdf/rdf_parser_raptor.c, librdf/rdf_parser.h, librdf/rdf_parser.c:
	parser methods, factory methods get_feature, set_feature now use
	librdf_node* for values.

	* configure.ac: check for getenv

	* utils/rdfproc.1:
	Document environment variables RDFPROC_STORAGE_OPTIONS and
	RDFPROC_STORAGE_TYPE

	* utils/rdfproc.c:
	Use environment variables RDFPROC_STORAGE_OPTIONS and
	RDFPROC_STORAGE_TYPE to provide default storage options (-t) 
	and type (-s)
	Apply in order environment variables, options, storage options.

2004-01-12  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_storage_mysql.c
	(librdf_storage_mysql_find_statements_in_context):
	Copy the query statement and/or query context_node so that they
	live during the streaming.
	(librdf_storage_mysql_find_statements_in_context_finished): Free them.

	* librdf/rdf_storage_mysql.c:
	(librdf_storage_mysql_find_statements_in_context_next_statement):
	Clear current_context pointer after free.

	* configure.ac: MySQL store works with V3.23.58 and maybe others?

	* librdf/rdf_storage_mysql.c: fix

	* librdf/rdf_storage_mysql.c (librdf_storage_mysql_init):
	Default to port 3306.

	* librdf/rdf_storage_mysql.c:
	(librdf_storage_mysql_get_contexts_next_context) row=

	* librdf/rdf_storage_mysql.c:
	(librdf_storage_mysql_find_statements_in_context_next_statement):
	Allow a NULL context to be returned.

2004-01-11  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* utils/rdfproc.c: contexts commands has no args

	* librdf/rdf_storage_list.c
	(librdf_storage_list_get_contexts_get_method): Use icontext in
	debug arg.

	* utils/rdfproc.1:
	Add find with contexts, contexts, parse-stream with contexts.

	* utils/rdfproc.c:
	Added CONTEXT arg to parse-stream to parse into a context.
	Fixed contexts command, now working.

	* utils/rdfproc.c: Added contexts command to list all contexts.
	Tidied warnings about using context commands with contexts disabled.

	* utils/rdfproc.c:
	Added 4th arg to find command, to find in a particular context
	invoking librdf_model_find_statements_in_context

	* librdf/rdf_storage_hashes.c
	(librdf_storage_hashes_context_serialise): Return NULL if no contexts.

	* utils/rdf-tree.c:
	V0.4 Removed id option Added -m/model, -q/quiet options.
	Now doesn't follow objects of rdf:type.

	* utils/rdf-load.c:
	Removed options id, rdf-parser. Added options input, model, quiet.
	read password from stdin

	* librdf/rdf_model_storage.c (librdf_model_storage_get_contexts):
	Added, implementing get_contexts for model_storage implementation.

	* librdf/rdf_storage_list.c (librdf_storage_list_get_contexts):
	Added to implement get_contexts
	along with:
	(librdf_storage_list_get_contexts_is_end
	librdf_storage_list_get_contexts_next_method
	librdf_storage_list_get_contexts_get_method
	librdf_storage_list_get_contexts_finished): Helper functions for
	the get_contexts method.

	* librdf/rdf_storage_hashes.c:
	Deleted librdf_storage_hashes_find_map and share the same code now in
	librdf_stream_statement_find_map

	* librdf/rdf_stream.h:
	Added prototoype for librdf_stream_statement_find_map

	* librdf/rdf_stream.c (librdf_stream_statement_find_map):
	Added, formerly librdf_storage_list_find_map

	* librdf/rdf_model.h:
	Add factory methods find_statements_in_context, get_contexts.
	Add prototypes for librdf_model_find_statements_in_context and
	librdf_model_get_contexts

	* librdf/rdf_model.c (librdf_model_find_statements_in_context):
	Added, calling
	the factory method otherwise using
	librdf_stream_statement_find_map over a stream of the
	statements in the context.
	(librdf_model_get_contexts): Added.
	(main): Test code, add a get_contexts call; does not yet work
	on memory, hashed stores.

	* librdf/rdf_storage.c (librdf_storage_stream_in_context_map): Deleted.
	(librdf_storage_find_statements_in_context): Do not use the above but
	use librdf_stream_statement_find_map over a stream of the
	statements in the context.

	* librdf/rdf_storage_list.c (librdf_storage_list_find_map): Renamed to
	librdf_stream_statement_find_map and moved to rdf_stream.c

	* librdf/rdf_storage_mysql.c:
	Enable factory methods find_statements_in_context, get_contexts.

	* librdf/rdf_storage.h:
	Add factory methods find_statements_in_context, get_contexts.
	Add prototypes for librdf_storage_find_statements_in_context and
	librdf_storage_get_contexts

	* librdf/rdf_storage.c (librdf_storage_stream_in_context_map):
	Added, helper for
	librdf_storage_find_statements_in_context when not in the factory.
	(librdf_storage_find_statements_in_context): Added.
	(librdf_storage_get_contexts): Added.

	* librdf/rdf_storage_list.c:
	(librdf_storage_list_find_map, librdf_storage_list_find_statements):
	Update to new stream map API.

	* librdf/rdf_storage_hashes.c:
	(librdf_storage_hashes_find_map, librdf_storage_hashes_find_statements):
	Update to new stream map API.

	* librdf/rdf_stream.h, librdf/rdf_stream.c:
	Change stream mapping to use a list of maps, matching the iterator
	code exactly except using librdf_statement*, not void*.
	Add typedefs librdf_stream_map_handler,
	librdf_stream_map_free_context_handler.
	Add librdf_stream_map internal structure.
	Change stream interals to use librdf_stream_map.
	Deleted librdf_stream_set_map.
	Added librdf_stream_add_map using typedefs.

	* librdf/rdf_iterator.h:
	Add free_context handler to librdf_iterator_map
	Define typedefs librdf_iterator_map_handler and
	librdf_iterator_map_free_context_handler
	Change librdf_iterator_add_map to have free_context handler arg.

	* librdf/rdf_iterator.c (librdf_iterator_free_iterator_map):
	Use free_context handler.
	(librdf_iterator_add_map): Add optional free_context handler,
	use typedefs.

	* librdf/rdf_storage_mysql.c: year 2004
	assgment in if()s fixes for gcc warnings.

	* librdf/rdf_storage_mysql.c: Import from morten 2004-01-11

2004-01-08  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* utils/rdfproc.1: Added remove-context command.

	* utils/rdfproc.c:
	Use parser features LIBRDF_PARSER_FEATURE_ERROR_COUNT
	LIBRDF_PARSER_FEATURE_WARNING_COUNT
	to get and report error and warning counts after parsing,
	if either of them is not 0.

2004-01-07  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_parser_raptor.c: Handle LIBRDF_PARSER_FEATURE_ERROR_COUNT
	LIBRDF_PARSER_FEATURE_WARNING_COUNT
	to return error and warning counts after (during?) a parser.
	Since the first error is fatal, it will either be 0 or 1.
	Warnings can be larger.
	(librdf_parser_raptor_get_feature): Added.

	* librdf/rdf_parser.h: Added
	LIBRDF_PARSER_FEATURE_ERROR_COUNT
	LIBRDF_PARSER_FEATURE_WARNING_COUNT

	* perl/lib/RDF/Redland/Parser.pm (parse_string_into_model):
	Fix to call the right function
	librdf_parser_parse_string_into_model

	* librdf/rdf_types.h, configure.ac: Restore u64 tests

	* utils/rdfproc.c: add missing closing }

	* librdf/rdf_storage.h, librdf/rdf_storage.c, librdf/rdf_model.c:
	Documentation: Note that context methods with a NULL context are
	equivalent to the equivalent methods without the context argument.

	* utils/rdfproc.c: On error, free(storage_password) only if set.

	* utils/rdfproc.c: de-torture some logic

	* utils/rdfproc.c:
	Tidy a lot of output and debug messages, s/model/graph/.
	Add command remove-context to invoke
	librdf_model_context_remove_statements

	* utils/rdfproc.1: Note the -p/--password.

	* utils/rdfproc.c:
	Added -p/--password to read a password as storage option 'password'
	from standard input.

	* utils/rdfproc.1: Note the -o/--output FORMAT

	* utils/rdfproc.c:
	Added -o FORMAT to set the output triples format.  Presently just for
	the find command but will apply later to query and others.

	* utils/Makefile.am: Remove update-api-0912.pl

	* utils/update-api-0912.pl: Old api script

	* utils/rdfproc.1: Note blank node, URI, literal syntax.

	* utils/rdfproc.c:
	Use librdf_heuristic_is_blank_node, librdf_heuristic_get_blank_node
	for arcs-in/out, has-arc-in/out

	* utils/rdfproc.c: add a mini rdf notation to rdfproc help
	Use librdf_heuristic_is_blank_node, librdf_heuristic_get_blank_node
	for context nodes with add, add-typed, remove commands.

	* utils/rdfproc.c:
	Use librdf_heuristic_is_blank_node, librdf_heuristic_get_blank_node
	and extend so all source/target/arc &+s commands use them
	as appropriate so blank nodes can be used wherever.

	* librdf/rdf_heuristics.h, librdf/rdf_heuristics.c:
	Added librdf_heuristic_is_blank_node, librdf_heuristic_get_blank_node

	* utils/rdfproc.c:
	Allow _:ABC for blank nodes in subject or object of statements.

2004-01-05  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* perl/Makefile.am:
	Don't pass on PACKAGE variable, Makefile.PL doesn't use it

	* perl/Makefile.PL:
	Don't use PACKAGE envariable; the name isn't changing now!
	Hard code CORE name also.

	* php/redland_wrap.c.patch: offsets again

	* librdf/rdf_model_storage.c
	(librdf_model_storage_context_serialize): Use
	librdf_storage_context_as_stream

	* librdf/rdf_storage_hashes.c: Add some int to
	librdf_statement_part casts.

	* librdf/redland.spec.in: - added redland-python package
	- export some more docs

2004-01-04  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* Redland.i: Remove deprecated librdf_iterator_have_elements

	* docs/redland.pod: Update to match current state; not yet automated.

	* librdf/rdf_stream.h: Make librdf_new_stream_from_node_iterator
	final arg be the enum.

	* librdf/rdf_iterator.h: note deprecation of
	librdf_iterator_have_elements

	* docs/Makefile.am: correctly substitute version in redland.3

	* Makefile.am: Make generated text files keep their links.  Only
	do the generation in maintainer mode.

	* examples/Makefile.am: Some reordering of arguments.
	Add building raptor rule, if needed

	* examples/Makefile.am: Do not ship example4

	* Redland.i: PHP also pollutes the auto* defines into public
	include files.

	* php/redland_wrap.c.patch: Updated

	* php/Makefile.am:
	Put the patching rules in the Makefile, maintainer mode

	* Redland.i: Add some extra prototypes for swig python

	* Redland.i: Do not export deprecated functions: librdf_init_world,
	librdf_destroy_world, librdf_model_serialise,
	librdf_model_context_serialize

	* librdf/rdf_serializer.h, librdf/rdf_parser.h, librdf/rdf_digest.h:
	Change void *c to void *_context in prototypes.  Helps
	remove some declaration shadowing warnings.

	* perl/Makefile.PL: Perl 5.8 is $]=5.008

	* librdf/rdf_uri.h, librdf/rdf_stream.h, librdf/rdf_stream.c,
	librdf/rdf_storage.h, librdf/rdf_storage.c,
	librdf/rdf_statement.h, librdf/rdf_statement.c,
	librdf/rdf_serializer.h, librdf/rdf_query.h, librdf/rdf_parser.h,
	librdf/rdf_node.h, librdf/rdf_model.h, librdf/rdf_iterator.h,
	librdf/rdf_init.h, librdf/rdf_concepts.h: Tidy up the headers,
	split internal/public stuff more clearly.  Export public functions
	with REDLAND_API

	* librdf/librdf.h: Moved internal stuff to rdf_internal.h; include it.

	* librdf/Makefile.am:
	Made rdf_hash.h rdf_digest.h rdf_types.h rdf_model_storage.h
	rdf_heuristics.h rdf_list.h rdf_hash_bdb.h rdf_hash_memory.
	rdf_files.h rdf_storage_list.h rdf_storage_hashes.h
	rdf_query_triples.h source-only headers, never installed.

	* librdf/rdf_storage_mysql.h, librdf/rdf_storage_tstore.h: Restored

	* librdf/rdf_internal.h: rdf_internal.h

2004-01-03  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_iterator.c (librdf_iterator_update_current_element):
	Fix iteration when using a
	list of map functions.
	(librdf_iterator_map_remove_duplicate_nodes): Deleted, never used.

	* librdf/rdf_storage.c (librdf_storage_node_stream_to_node_create):
	and nearby, remove
	prototypical duplicate removing options since it never worked and
	changing it now would confuse.

	* librdf/rdf_storage.c: Removed rdf_storage_mysql/tstore.h

	* librdf/rdf_storage.h: Moved mysql, tstore prototypes here.

	* librdf/rdf_storage_tstore.c: Removed rdf_storage_tstore.h

	* librdf/rdf_storage_tstore.h, librdf/rdf_storage_mysql.h:
	1 function defined here moved to rdf_storage.h

	* librdf/librdf.h: restore accidently deleted #endif

	* librdf/librdf.h: No longer NEED_EXPAT_SOURCE

	* librdf/redland.spec.in, librdf/redland.pc.in: name

	* librdf/librdf.h: comment

	* Makefile.am: Make TODO up to date

	* librdf/rdf_parser_raptor.c: Correctly use SYSTEM_FREE

	* librdf/rdf_parser_raptor.c:
	Remove some FIXMEs; replacing LIBRDF_FREE with SYSTEM_FREE now that
	raptor is never compiled with redland internals enabled even when in
	the source tree.

2004-01-02  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* librdf/rdf_parser_raptor.c (librdf_parser_raptor_parse_file_as_stream):
	Use pcontext->parser_name with raptor_new_parser.
	(librdf_parser_raptor_constructor): Register the default parser
	last always (rdfxml) and preserve the raptor old name as a true
	alias.

2004-01-01  Dave Beckett  <Dave.Beckett@bristol.ac.uk>

	* raptor/raptor_general.c: casts for string ops

	* raptor/raptor_www.c, raptor/raptor_internal.h, raptor/configure.ac:
	Added WWW access with BSD libfetch.

	* raptor/raptor_www_libfetch.c: WWW access with BSD libfetch

